<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="hider"><title>JDBCåŸºç¡€æ•™ç¨‹ | Hider&#39;s home</title><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/font/css/fontawesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/font/css/regular.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/font/css/solid.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/font/css/brands.min.css"><script class="keep-theme-configurations">const KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"example.com",root:"/",language:"zh-CN",path:"search.json"},KEEP.theme_config={base_info:{title:"Hider's home",author:"hider"},menu:{"ä¸»é¡µ":"/","å½’æ¡£":"/archives","åˆ†ç±»":"/categories","å…³äºæˆ‘":"/about"},first_screen:{enable:!1,background_img:"/images/bg.svg",background_img_dark:"/images/bg.svg",description:"Keep writing and Keep loving.",hitokoto:!1},social_contact:{enable:!0,links:{github:"https://github.com/qaqaqaaaa",weixin:null,qq:null,weibo:null,zhihu:null,twitter:null,facebook:null,email:null}},scroll:{progress_bar:!1,percent:!1,hide_header:!0},home:{announcement:null,category:!1,tag:!1,post_datetime:"updated"},post:{author_label:{enable:!1,auto:!0,custom_label_list:["Trainee","Engineer","Architect"]},word_count:{enable:!0,wordcount:!0,min2read:!1},img_align:"center",copyright_info:!1},code_block:{tools:{enable:!0,style:"default"},highlight_theme:"obsidian"},toc:{enable:!0,number:!0,expand_all:!0,init_open:!0},website_count:{busuanzi_count:{enable:!1,site_uv:!1,site_pv:!1,page_pv:!1}},local_search:{enable:!0,preload:!0},comment:{enable:!0,use:"waline",valine:{appid:"AvflWxMrGjwe7BNa6OUGXHoX-gzGzoHsz",appkey:"IC2gTItOUkPhmSCTS6BBX52z",server_urls:null,placeholder:"ğŸ˜œ å°½æƒ…åæ§½å§~"},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.8"},waline:{server_url:"https://hexo-waline-comment-bay.vercel.app/",reaction:!0,version:3}},rss:{enable:!1},lazyload:{enable:!0},cdn:{enable:!0,provider:"jsdelivr"},pjax:{enable:!0},footer:{since:2020,icp:null,site_deploy:{enable:!0,provider:"github",url:null}},inject:{enable:!1,css:[null],js:[null]},root:"",style:{primary_color:"#0066cc",logo:"/images/logo.svg",favicon:"/images/logo.svg",avatar:"https://cdn.jsdelivr.net/gh/qaqaqaaaa/picx-images-hosting@master/20230423/avatar.1nablq4dl068.svg",font_size:null,font_family:null,hover:{shadow:!1,scale:!1},first_screen:{enable:!0,header_transparent:!1,background_img:"/images/bg.svg",description:"Keep writing and Keep loving.",font_color:null,hitokoto:!1},scroll:{progress_bar:!1,percent:!0}},home_article:{category:{enable:!1,limit:3},tag:{enable:!0,limit:5}},source_data:{},version:"4.2.5"},KEEP.language_ago={second:"%s ç§’å‰",minute:"%s åˆ†é’Ÿå‰",hour:"%s å°æ—¶å‰",day:"%s å¤©å‰",week:"%s å‘¨å‰",month:"%s ä¸ªæœˆå‰",year:"%s å¹´å‰"},KEEP.language_code_block={copy:"å¤åˆ¶ä»£ç ",copied:"å·²å¤åˆ¶",fold:"æŠ˜å ä»£ç å—",folded:"å·²æŠ˜å "},KEEP.language_copy_copyright={copy:"å¤åˆ¶ç‰ˆæƒä¿¡æ¯",copied:"å·²å¤åˆ¶",title:"åŸæ–‡æ ‡é¢˜",author:"åŸæ–‡ä½œè€…",link:"åŸæ–‡é“¾æ¥"}</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span> <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i></div><main class="page-container border-box"><div class="page-main-content border-box"><div class="page-main-content-top"><header class="header-wrapper"><div class="border-box header-content"><div class="left flex-start border-box"><a class="site-name border-box" href="/">Hider&#39;s home</a></div><div class="right border-box"><div class="pc border-box"><ul class="menu-list border-box"><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href="/">ä¸»é¡µ</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href="/archives">å½’æ¡£</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href="/categories">åˆ†ç±»</a></li><li class="menu-item flex-start border-box"><a class="menu-text-color border-box" href="/about">å…³äºæˆ‘</a></li><li class="menu-item search search-popup-trigger"><i class="menu-text-color fas search fa-search"></i></li></ul></div><div class="mobile border-box flex-start"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list border-box"><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href="/">ä¸»é¡µ</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">å½’æ¡£</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">åˆ†ç±»</a></label></li><li class="drawer-menu-item border-box not-sub-menu"><label class="drawer-menu-label border-box"><a class="drawer-menu-text-color left-side flex-start border-box" href="/about">å…³äºæˆ‘</a></label></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle border-box"><div class="main-content border-box"><div class="fade-in-down-animation"><div class="post-page-container border-box"><div class="post-content-container border-box"><div class="post-content-bottom border-box"><div class="post-title">JDBCåŸºç¡€æ•™ç¨‹</div><div class="post-header border-box"><div class="info-box"><div class="author border-box"><span class="name">hider</span></div><div class="meta-info border-box"><div class="post-meta-info-container border-box post"><div class="post-meta-info border-box"><span class="meta-info-item post-create-date"><i class="icon fa-solid fa-calendar-plus"></i>&nbsp; <span class="datetime">2021-08-25 17:43:20</span> </span><span class="meta-info-item post-update-date"><i class="icon fa-solid fa-file-pen"></i>&nbsp; <span class="datetime" data-updated="Sun Apr 23 2023 20:31:54 GMT+0800">2023-04-23 20:31:54</span> </span><span class="meta-info-item post-wordcount"><i class="icon fas fa-file-word"></i>&nbsp;<span>15.2k å­—</span></span></div></div></div></div></div><div class="post-content keep-markdown-body"><h1 id="JDBCæ ¸å¿ƒæŠ€æœ¯"><a href="#JDBCæ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="JDBCæ ¸å¿ƒæŠ€æœ¯"></a>JDBCæ ¸å¿ƒæŠ€æœ¯</h1><p>è®²å¸ˆï¼šå®‹çº¢åº·</p><p>å¾®åšï¼šå°šç¡…è°·-å®‹çº¢åº·</p><hr><h2 id="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"><a href="#ç¬¬1ç« ï¼šJDBCæ¦‚è¿°" class="headerlink" title="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"></a>ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</h2><h3 id="1-1-æ•°æ®çš„æŒä¹…åŒ–"><a href="#1-1-æ•°æ®çš„æŒä¹…åŒ–" class="headerlink" title="1.1 æ•°æ®çš„æŒä¹…åŒ–"></a>1.1 æ•°æ®çš„æŒä¹…åŒ–</h3><ul><li><p>æŒä¹…åŒ–(persistence)ï¼š<strong>æŠŠæ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾›ä¹‹åä½¿ç”¨</strong>ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œ<strong>æ•°æ®æŒä¹…åŒ–æ„å‘³ç€å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜</strong>ä¸ŠåŠ ä»¥â€å›ºåŒ–â€<strong>ï¼Œè€ŒæŒä¹…åŒ–çš„å®ç°è¿‡ç¨‹å¤§å¤šé€šè¿‡å„ç§å…³ç³»æ•°æ®åº“æ¥å®Œæˆ</strong>ã€‚</p></li><li><p>æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ã€XMLæ•°æ®æ–‡ä»¶ä¸­ã€‚<br><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566741430592.png"></p></li></ul><h3 id="1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"><a href="#1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯" class="headerlink" title="1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"></a>1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</h3><ul><li><p>åœ¨Javaä¸­ï¼Œæ•°æ®åº“å­˜å–æŠ€æœ¯å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p><ul><li><p><strong>JDBC</strong>ç›´æ¥è®¿é—®æ•°æ®åº“</p></li><li><p>JDO (Java Data Object )æŠ€æœ¯</p></li><li><p><strong>ç¬¬ä¸‰æ–¹O&#x2F;Rå·¥å…·</strong>ï¼Œå¦‚Hibernate, Mybatis ç­‰</p></li></ul></li><li><p>JDBCæ˜¯javaè®¿é—®æ•°æ®åº“çš„åŸºçŸ³ï¼ŒJDOã€Hibernateã€MyBatisç­‰åªæ˜¯æ›´å¥½çš„å°è£…äº†JDBCã€‚</p></li></ul><h3 id="1-3-JDBCä»‹ç»"><a href="#1-3-JDBCä»‹ç»" class="headerlink" title="1.3 JDBCä»‹ç»"></a>1.3 JDBCä»‹ç»</h3><ul><li>JDBC(Java Database Connectivity)æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹äºç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€é€šç”¨çš„SQLæ•°æ®åº“å­˜å–å’Œæ“ä½œçš„å…¬å…±æ¥å£</strong>ï¼ˆä¸€ç»„APIï¼‰ï¼Œå®šä¹‰äº†ç”¨æ¥è®¿é—®æ•°æ®åº“çš„æ ‡å‡†Javaç±»åº“ï¼Œï¼ˆ<strong>java.sql,javax.sql</strong>ï¼‰ä½¿ç”¨è¿™äº›ç±»åº“å¯ä»¥ä»¥ä¸€ç§<strong>æ ‡å‡†</strong>çš„æ–¹æ³•ã€æ–¹ä¾¿åœ°è®¿é—®æ•°æ®åº“èµ„æºã€‚</li><li>JDBCä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ä¸€ç§<strong>ç»Ÿä¸€çš„é€”å¾„</strong>ï¼Œä¸ºå¼€å‘è€…å±è”½äº†ä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚</li><li>JDBCçš„ç›®æ ‡æ˜¯ä½¿Javaç¨‹åºå‘˜ä½¿ç”¨JDBCå¯ä»¥è¿æ¥ä»»ä½•<strong>æä¾›äº†JDBCé©±åŠ¨ç¨‹åº</strong>çš„æ•°æ®åº“ç³»ç»Ÿï¼Œè¿™æ ·å°±ä½¿å¾—ç¨‹åºå‘˜æ— éœ€å¯¹ç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ç‰¹ç‚¹æœ‰è¿‡å¤šçš„äº†è§£ï¼Œä»è€Œå¤§å¤§ç®€åŒ–å’ŒåŠ å¿«äº†å¼€å‘è¿‡ç¨‹ã€‚</li><li>å¦‚æœæ²¡æœ‰JDBCï¼Œé‚£ä¹ˆJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555575760234.png"></p><hr><ul><li>æœ‰äº†JDBCï¼ŒJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555575981203.png"></p><hr><ul><li>æ€»ç»“å¦‚ä¸‹ï¼š</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566741692804.png"></p><h3 id="1-4-JDBCä½“ç³»ç»“æ„"><a href="#1-4-JDBCä½“ç³»ç»“æ„" class="headerlink" title="1.4 JDBCä½“ç³»ç»“æ„"></a>1.4 JDBCä½“ç³»ç»“æ„</h3><ul><li>JDBCæ¥å£ï¼ˆAPIï¼‰åŒ…æ‹¬ä¸¤ä¸ªå±‚æ¬¡ï¼š<ul><li><strong>é¢å‘åº”ç”¨çš„API</strong>ï¼šJava APIï¼ŒæŠ½è±¡æ¥å£ï¼Œä¾›åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä½¿ç”¨ï¼ˆè¿æ¥æ•°æ®åº“ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å¾—ç»“æœï¼‰ã€‚</li><li><strong>é¢å‘æ•°æ®åº“çš„API</strong>ï¼šJava Driver APIï¼Œä¾›å¼€å‘å•†å¼€å‘æ•°æ®åº“é©±åŠ¨ç¨‹åºç”¨ã€‚</li></ul></li></ul><blockquote><p><strong>JDBCæ˜¯sunå…¬å¸æä¾›ä¸€å¥—ç”¨äºæ•°æ®åº“æ“ä½œçš„æ¥å£ï¼Œjavaç¨‹åºå‘˜åªéœ€è¦é¢å‘è¿™å¥—æ¥å£ç¼–ç¨‹å³å¯ã€‚</strong></p><p><strong>ä¸åŒçš„æ•°æ®åº“å‚å•†ï¼Œéœ€è¦é’ˆå¯¹è¿™å¥—æ¥å£ï¼Œæä¾›ä¸åŒå®ç°ã€‚ä¸åŒçš„å®ç°çš„é›†åˆï¼Œå³ä¸ºä¸åŒæ•°æ®åº“çš„é©±åŠ¨ã€‚ â€”â€”â€”â€”é¢å‘æ¥å£ç¼–ç¨‹</strong></p></blockquote><h3 id="1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤"><a href="#1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤" class="headerlink" title="1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤"></a>1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</h3><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1565969323908.png"></p><blockquote><p>è¡¥å……ï¼šODBC(<strong>Open Database Connectivity</strong>ï¼Œå¼€æ”¾å¼æ•°æ®åº“è¿æ¥)ï¼Œæ˜¯å¾®è½¯åœ¨Windowså¹³å°ä¸‹æ¨å‡ºçš„ã€‚ä½¿ç”¨è€…åœ¨ç¨‹åºä¸­åªéœ€è¦è°ƒç”¨ODBC APIï¼Œç”± ODBC é©±åŠ¨ç¨‹åºå°†è°ƒç”¨è½¬æ¢æˆä¸ºå¯¹ç‰¹å®šçš„æ•°æ®åº“çš„è°ƒç”¨è¯·æ±‚ã€‚</p></blockquote><h2 id="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"><a href="#ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥" class="headerlink" title="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"></a>ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</h2><h3 id="2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"><a href="#2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»" class="headerlink" title="2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"></a>2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</h3><h4 id="2-1-1-Driveræ¥å£ä»‹ç»"><a href="#2-1-1-Driveræ¥å£ä»‹ç»" class="headerlink" title="2.1.1 Driveræ¥å£ä»‹ç»"></a>2.1.1 Driveræ¥å£ä»‹ç»</h4><ul><li><p>java.sql.Driver æ¥å£æ˜¯æ‰€æœ‰ JDBC é©±åŠ¨ç¨‹åºéœ€è¦å®ç°çš„æ¥å£ã€‚è¿™ä¸ªæ¥å£æ˜¯æä¾›ç»™æ•°æ®åº“å‚å•†ä½¿ç”¨çš„ï¼Œä¸åŒæ•°æ®åº“å‚å•†æä¾›ä¸åŒçš„å®ç°ã€‚</p></li><li><p>åœ¨ç¨‹åºä¸­ä¸éœ€è¦ç›´æ¥å»è®¿é—®å®ç°äº† Driver æ¥å£çš„ç±»ï¼Œè€Œæ˜¯ç”±é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»(java.sql.DriverManager)å»è°ƒç”¨è¿™äº›Driverå®ç°ã€‚</p><ul><li>Oracleçš„é©±åŠ¨ï¼š<strong>oracle.jdbc.driver.OracleDriver</strong></li><li>mySqlçš„é©±åŠ¨ï¼š <strong>com.mysql.jdbc.Driver</strong></li></ul></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555576157618.png"></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555576170074.png"></p><ul><li>å°†ä¸Šè¿°jaråŒ…æ‹·è´åˆ°Javaå·¥ç¨‹çš„ä¸€ä¸ªç›®å½•ä¸­ï¼Œä¹ æƒ¯ä¸Šæ–°å»ºä¸€ä¸ªlibæ–‡ä»¶å¤¹ã€‚<br><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566134718955.png"></li></ul><p>åœ¨é©±åŠ¨jarä¸Šå³é”®â€“&gt;Build Pathâ€“&gt;Add to Build Path</p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566134781682.png"></p><p>æ³¨æ„ï¼šå¦‚æœæ˜¯Dynamic Web Projectï¼ˆåŠ¨æ€çš„webé¡¹ç›®ï¼‰è¯ï¼Œåˆ™æ˜¯æŠŠé©±åŠ¨jaræ”¾åˆ°WebContentï¼ˆæœ‰çš„å¼€å‘å·¥å…·å«WebRootï¼‰ç›®å½•ä¸­çš„WEB-INFç›®å½•ä¸­çš„libç›®å½•ä¸‹å³å¯</p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566135290460.png"></p><h4 id="2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"><a href="#2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨" class="headerlink" title="2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"></a>2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</h4><ul><li><p>åŠ è½½é©±åŠ¨ï¼šåŠ è½½ JDBC é©±åŠ¨éœ€è°ƒç”¨ Class ç±»çš„é™æ€æ–¹æ³• forName()ï¼Œå‘å…¶ä¼ é€’è¦åŠ è½½çš„ JDBC é©±åŠ¨çš„ç±»å</p><ul><li><strong>Class.forName(â€œcom.mysql.jdbc.Driverâ€);</strong></li></ul></li><li><p>æ³¨å†Œé©±åŠ¨ï¼šDriverManager ç±»æ˜¯é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»ï¼Œè´Ÿè´£ç®¡ç†é©±åŠ¨ç¨‹åº</p><ul><li><p><strong>ä½¿ç”¨DriverManager.registerDriver(com.mysql.jdbc.Driver)æ¥æ³¨å†Œé©±åŠ¨</strong></p></li><li><p>é€šå¸¸ä¸ç”¨æ˜¾å¼è°ƒç”¨ DriverManager ç±»çš„ registerDriver() æ–¹æ³•æ¥æ³¨å†Œé©±åŠ¨ç¨‹åºç±»çš„å®ä¾‹ï¼Œå› ä¸º Driver æ¥å£çš„é©±åŠ¨ç¨‹åºç±»<strong>éƒ½</strong>åŒ…å«äº†é™æ€ä»£ç å—ï¼Œåœ¨è¿™ä¸ªé™æ€ä»£ç å—ä¸­ï¼Œä¼šè°ƒç”¨ DriverManager.registerDriver() æ–¹æ³•æ¥æ³¨å†Œè‡ªèº«çš„ä¸€ä¸ªå®ä¾‹ã€‚ä¸‹å›¾æ˜¯MySQLçš„Driverå®ç°ç±»çš„æºç ï¼š<br><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566136831283.png"></p></li></ul></li></ul><h3 id="2-2-è¦ç´ äºŒï¼šURL"><a href="#2-2-è¦ç´ äºŒï¼šURL" class="headerlink" title="2.2 è¦ç´ äºŒï¼šURL"></a>2.2 è¦ç´ äºŒï¼šURL</h3><ul><li><p>JDBC URL ç”¨äºæ ‡è¯†ä¸€ä¸ªè¢«æ³¨å†Œçš„é©±åŠ¨ç¨‹åºï¼Œé©±åŠ¨ç¨‹åºç®¡ç†å™¨é€šè¿‡è¿™ä¸ª URL é€‰æ‹©æ­£ç¡®çš„é©±åŠ¨ç¨‹åºï¼Œä»è€Œå»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥ã€‚</p></li><li><p>JDBC URLçš„æ ‡å‡†ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå„éƒ¨åˆ†é—´ç”¨å†’å·åˆ†éš”ã€‚</p><ul><li><strong>jdbc:å­åè®®:å­åç§°</strong></li><li><strong>åè®®</strong>ï¼šJDBC URLä¸­çš„åè®®æ€»æ˜¯jdbc</li><li><strong>å­åè®®</strong>ï¼šå­åè®®ç”¨äºæ ‡è¯†ä¸€ä¸ªæ•°æ®åº“é©±åŠ¨ç¨‹åº</li><li><strong>å­åç§°</strong>ï¼šä¸€ç§æ ‡è¯†æ•°æ®åº“çš„æ–¹æ³•ã€‚å­åç§°å¯ä»¥ä¾ä¸åŒçš„å­åè®®è€Œå˜åŒ–ï¼Œç”¨å­åç§°çš„ç›®çš„æ˜¯ä¸ºäº†<strong>å®šä½æ•°æ®åº“</strong>æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ã€‚åŒ…å«<strong>ä¸»æœºå</strong>(å¯¹åº”æœåŠ¡ç«¯çš„ipåœ°å€)<strong>ï¼Œç«¯å£å·ï¼Œæ•°æ®åº“å</strong></li></ul></li><li><p>ä¸¾ä¾‹ï¼š<br><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555576477107.png"></p></li><li><p><strong>å‡ ç§å¸¸ç”¨æ•°æ®åº“çš„ JDBC URL</strong></p><ul><li><p>MySQLçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li>jdbc:mysql:&#x2F;&#x2F;ä¸»æœºåç§°:mysqlæœåŠ¡ç«¯å£å·&#x2F;æ•°æ®åº“åç§°?å‚æ•°&#x3D;å€¼&amp;å‚æ•°&#x3D;å€¼</li><li>jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;atguigu</li><li>jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;atguigu**?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf8**ï¼ˆå¦‚æœJDBCç¨‹åºä¸æœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´ä¹±ç ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šæœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ï¼‰</li><li>jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;atguigu?user&#x3D;root&amp;password&#x3D;123456</li></ul></li><li><p>Oracle 9içš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li>jdbc:oracle:thin:@ä¸»æœºåç§°:oracleæœåŠ¡ç«¯å£å·:æ•°æ®åº“åç§°</li><li>jdbc:oracle:thin:@localhost:1521:atguigu</li></ul></li><li><p>SQLServerçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li><p>jdbc:sqlserver:&#x2F;&#x2F;ä¸»æœºåç§°:sqlserveræœåŠ¡ç«¯å£å·:DatabaseName&#x3D;æ•°æ®åº“åç§°</p></li><li><p>jdbc:sqlserver:&#x2F;&#x2F;localhost:1433:DatabaseName&#x3D;atguigu</p></li></ul></li></ul></li></ul><h3 id="2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "><a href="#2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "></a>2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </h3><ul><li>user,passwordå¯ä»¥ç”¨â€œå±æ€§å&#x3D;å±æ€§å€¼â€æ–¹å¼å‘Šè¯‰æ•°æ®åº“</li><li>å¯ä»¥è°ƒç”¨ DriverManager ç±»çš„ getConnection() æ–¹æ³•å»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥</li></ul><h3 id="2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"><a href="#2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹" class="headerlink" title="2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"></a>2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</h3><h4 id="2-4-1-è¿æ¥æ–¹å¼ä¸€"><a href="#2-4-1-è¿æ¥æ–¹å¼ä¸€" class="headerlink" title="2.4.1 è¿æ¥æ–¹å¼ä¸€"></a>2.4.1 è¿æ¥æ–¹å¼ä¸€</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConnection1</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.æä¾›java.sql.Driveræ¥å£å®ç°ç±»çš„å¯¹è±¡</span></span><br><span class="line">        <span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        driver = <span class="keyword">new</span> <span class="title class_">com</span>.mysql.jdbc.Driver();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        info.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        info.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;abc123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> driver.connect(url, info);</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä¸Šè¿°ä»£ç ä¸­æ˜¾å¼å‡ºç°äº†ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„API</p></blockquote><h4 id="2-4-2-è¿æ¥æ–¹å¼äºŒ"><a href="#2-4-2-è¿æ¥æ–¹å¼äºŒ" class="headerlink" title="2.4.2 è¿æ¥æ–¹å¼äºŒ"></a>2.4.2 è¿æ¥æ–¹å¼äºŒ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConnection2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.å®ä¾‹åŒ–Driver</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">        <span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> (Driver) clazz.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        info.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        info.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;abc123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> driver.connect(url, info);</span><br><span class="line">        System.out.println(conn);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šç›¸è¾ƒäºæ–¹å¼ä¸€ï¼Œè¿™é‡Œä½¿ç”¨åå°„å®ä¾‹åŒ–Driverï¼Œä¸åœ¨ä»£ç ä¸­ä½“ç°ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„APIã€‚ä½“ç°äº†é¢å‘æ¥å£ç¼–ç¨‹æ€æƒ³ã€‚</p></blockquote><h4 id="2-4-3-è¿æ¥æ–¹å¼ä¸‰"><a href="#2-4-3-è¿æ¥æ–¹å¼ä¸‰" class="headerlink" title="2.4.3 è¿æ¥æ–¹å¼ä¸‰"></a>2.4.3 è¿æ¥æ–¹å¼ä¸‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConnection3</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;abc123&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">driverName</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.å®ä¾‹åŒ–Driver</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(driverName);</span><br><span class="line">        <span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> (Driver) clazz.newInstance();</span><br><span class="line">        <span class="comment">//3.æ³¨å†Œé©±åŠ¨</span></span><br><span class="line">        DriverManager.registerDriver(driver);</span><br><span class="line">        <span class="comment">//4.è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨DriverManagerå®ç°æ•°æ®åº“çš„è¿æ¥ã€‚ä½“ä¼šè·å–è¿æ¥å¿…è¦çš„4ä¸ªåŸºæœ¬è¦ç´ ã€‚</p></blockquote><h4 id="2-4-4-è¿æ¥æ–¹å¼å››"><a href="#2-4-4-è¿æ¥æ–¹å¼å››" class="headerlink" title="2.4.4 è¿æ¥æ–¹å¼å››"></a>2.4.4 è¿æ¥æ–¹å¼å››</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConnection4</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;abc123&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">driverName</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.åŠ è½½é©±åŠ¨ ï¼ˆâ‘ å®ä¾‹åŒ–Driver â‘¡æ³¨å†Œé©±åŠ¨ï¼‰</span></span><br><span class="line">        Class.forName(driverName);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//Driver driver = (Driver) clazz.newInstance();</span></span><br><span class="line">        <span class="comment">//3.æ³¨å†Œé©±åŠ¨</span></span><br><span class="line">        <span class="comment">//DriverManager.registerDriver(driver);</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        å¯ä»¥æ³¨é‡Šæ‰ä¸Šè¿°ä»£ç çš„åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨mysqlçš„Driverç±»ä¸­å£°æ˜æœ‰ï¼š</span></span><br><span class="line"><span class="comment">        static &#123;</span></span><br><span class="line"><span class="comment">            try &#123;</span></span><br><span class="line"><span class="comment">                DriverManager.registerDriver(new Driver());</span></span><br><span class="line"><span class="comment">            &#125; catch (SQLException var1) &#123;</span></span><br><span class="line"><span class="comment">                throw new RuntimeException(&quot;Can&#x27;t register driver!&quot;);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä¸å¿…æ˜¾å¼çš„æ³¨å†Œé©±åŠ¨äº†ã€‚å› ä¸ºåœ¨DriverManagerçš„æºç ä¸­å·²ç»å­˜åœ¨é™æ€ä»£ç å—ï¼Œå®ç°äº†é©±åŠ¨çš„æ³¨å†Œã€‚</p></blockquote><h4 id="2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ"><a href="#2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ" class="headerlink" title="2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)"></a>2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">testConnection5</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//1.åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> ConnectionTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line">    <span class="type">Properties</span> <span class="variable">pros</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">    pros.load(is);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.è¯»å–é…ç½®ä¿¡æ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">driverClass</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;driverClass&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.åŠ è½½é©±åŠ¨</span></span><br><span class="line">    Class.forName(driverClass);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.è·å–è¿æ¥</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url,user,password);</span><br><span class="line">    System.out.println(conn);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œé…ç½®æ–‡ä»¶å£°æ˜åœ¨å·¥ç¨‹çš„srcç›®å½•ä¸‹ï¼šã€jdbc.propertiesã€‘</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">abc123</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/test</span></span><br><span class="line"><span class="attr">driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼ä¿å­˜é…ç½®ä¿¡æ¯ï¼Œåœ¨ä»£ç ä¸­åŠ è½½é…ç½®æ–‡ä»¶</p><p><strong>ä½¿ç”¨é…ç½®æ–‡ä»¶çš„å¥½å¤„ï¼š</strong></p><p>â‘ å®ç°äº†ä»£ç å’Œæ•°æ®çš„åˆ†ç¦»ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œä¸éœ€è¦æ·±å…¥ä»£ç <br>â‘¡å¦‚æœä¿®æ”¹äº†é…ç½®ä¿¡æ¯ï¼Œçœå»é‡æ–°ç¼–è¯‘çš„è¿‡ç¨‹ã€‚</p></blockquote><h2 id="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"><a href="#ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"></a>ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</h2><h3 id="3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“"><a href="#3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“" class="headerlink" title="3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“"></a>3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</h3><ul><li><p>æ•°æ®åº“è¿æ¥è¢«ç”¨äºå‘æ•°æ®åº“æœåŠ¡å™¨å‘é€å‘½ä»¤å’Œ SQL è¯­å¥ï¼Œå¹¶æ¥å—æ•°æ®åº“æœåŠ¡å™¨è¿”å›çš„ç»“æœã€‚å…¶å®ä¸€ä¸ªæ•°æ®åº“è¿æ¥å°±æ˜¯ä¸€ä¸ªSocketè¿æ¥ã€‚</p></li><li><p>åœ¨ java.sql åŒ…ä¸­æœ‰ 3 ä¸ªæ¥å£åˆ†åˆ«å®šä¹‰äº†å¯¹æ•°æ®åº“çš„è°ƒç”¨çš„ä¸åŒæ–¹å¼ï¼š</p><ul><li>Statementï¼šç”¨äºæ‰§è¡Œé™æ€ SQL è¯­å¥å¹¶è¿”å›å®ƒæ‰€ç”Ÿæˆç»“æœçš„å¯¹è±¡ã€‚</li><li>PrepatedStatementï¼šSQL è¯­å¥è¢«é¢„ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ­¤å¯¹è±¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å¯¹è±¡å¤šæ¬¡é«˜æ•ˆåœ°æ‰§è¡Œè¯¥è¯­å¥ã€‚</li><li>CallableStatementï¼šç”¨äºæ‰§è¡Œ SQL å­˜å‚¨è¿‡ç¨‹</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566573842140.png"></p></li></ul><h3 id="3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"><a href="#3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯" class="headerlink" title="3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"></a>3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</h3><ul><li><p>é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ createStatement() æ–¹æ³•åˆ›å»ºè¯¥å¯¹è±¡ã€‚è¯¥å¯¹è±¡ç”¨äºæ‰§è¡Œé™æ€çš„ SQL è¯­å¥ï¼Œå¹¶ä¸”è¿”å›æ‰§è¡Œç»“æœã€‚</p></li><li><p>Statement æ¥å£ä¸­å®šä¹‰äº†ä¸‹åˆ—æ–¹æ³•ç”¨äºæ‰§è¡Œ SQL è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> excuteUpdate(String <span class="keyword">sql</span>)ï¼šæ‰§è¡Œæ›´æ–°æ“ä½œ<span class="keyword">INSERT</span>ã€<span class="keyword">UPDATE</span>ã€<span class="keyword">DELETE</span></span><br><span class="line">ResultSet executeQuery(String <span class="keyword">sql</span>)ï¼šæ‰§è¡ŒæŸ¥è¯¢æ“ä½œ<span class="keyword">SELECT</span></span><br></pre></td></tr></table></figure></li><li><p>ä½†æ˜¯ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨å­˜åœ¨å¼Šç«¯ï¼š</p><ul><li><strong>é—®é¢˜ä¸€ï¼šå­˜åœ¨æ‹¼ä¸²æ“ä½œï¼Œç¹ç</strong></li><li><strong>é—®é¢˜äºŒï¼šå­˜åœ¨SQLæ³¨å…¥é—®é¢˜</strong></li></ul></li><li><p>SQL æ³¨å…¥æ˜¯åˆ©ç”¨æŸäº›ç³»ç»Ÿæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå……åˆ†çš„æ£€æŸ¥ï¼Œè€Œåœ¨ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­æ³¨å…¥éæ³•çš„ SQL è¯­å¥æ®µæˆ–å‘½ä»¤(å¦‚ï¼šSELECT user, password FROM user_table WHERE user&#x3D;â€™aâ€™ OR 1 &#x3D; â€˜ AND password &#x3D; â€˜ OR â€˜1â€™ &#x3D; â€˜1â€™) ï¼Œä»è€Œåˆ©ç”¨ç³»ç»Ÿçš„ SQL å¼•æ“å®Œæˆæ¶æ„è¡Œä¸ºçš„åšæ³•ã€‚</p></li><li><p>å¯¹äº Java è€Œè¨€ï¼Œè¦é˜²èŒƒ SQL æ³¨å…¥ï¼Œåªè¦ç”¨ PreparedStatement(ä»Statementæ‰©å±•è€Œæ¥) å–ä»£ Statement å°±å¯ä»¥äº†ã€‚</p></li><li><p>ä»£ç æ¼”ç¤ºï¼š</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StatementTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Statementçš„å¼Šç«¯ï¼šéœ€è¦æ‹¼å†™sqlè¯­å¥ï¼Œå¹¶ä¸”å­˜åœ¨SQLæ³¨å…¥çš„é—®é¢˜</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLogin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">        System.out.print(<span class="string">&quot;ç”¨æˆ·åï¼š&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> scan.nextLine();</span><br><span class="line">        System.out.print(<span class="string">&quot;å¯†   ç ï¼š&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> scan.nextLine();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// SELECT user,password FROM user_table WHERE USER = &#x27;1&#x27; or &#x27; AND PASSWORD = &#x27;=&#x27;1&#x27; or &#x27;1&#x27; = &#x27;1&#x27;;</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT user,password FROM user_table WHERE USER = &#x27;&quot;</span> + userName + <span class="string">&quot;&#x27; AND PASSWORD = &#x27;&quot;</span> + password</span><br><span class="line">                + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> get(sql, User.class);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç™»é™†æˆåŠŸ!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Statementå®ç°å¯¹æ•°æ®è¡¨çš„æŸ¥è¯¢æ“ä½œ</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">get</span><span class="params">(String sql, Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> StatementTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">pros</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            pros.load(is);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2.è¯»å–é…ç½®ä¿¡æ¯</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">driverClass</span> <span class="operator">=</span> pros.getProperty(<span class="string">&quot;driverClass&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3.åŠ è½½é©±åŠ¨</span></span><br><span class="line">            Class.forName(driverClass);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4.è·å–è¿æ¥</span></span><br><span class="line">            conn = DriverManager.getConnection(url, user, password);</span><br><span class="line"></span><br><span class="line">            st = conn.createStatement();</span><br><span class="line"></span><br><span class="line">            rs = st.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–ç»“æœé›†çš„åˆ—æ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line"></span><br><span class="line">                t = clazz.newInstance();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;</span><br><span class="line">                    <span class="comment">// //1. è·å–åˆ—çš„åç§°</span></span><br><span class="line">                    <span class="comment">// String columnName = rsmd.getColumnName(i+1);</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 1. è·å–åˆ—çš„åˆ«å</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 2. æ ¹æ®åˆ—åè·å–å¯¹åº”æ•°æ®è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">columnVal</span> <span class="operator">=</span> rs.getObject(columnName);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 3. å°†æ•°æ®è¡¨ä¸­å¾—åˆ°çš„æ•°æ®ï¼Œå°è£…è¿›å¯¹è±¡</span></span><br><span class="line">                    <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnName);</span><br><span class="line">                    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    field.set(t, columnVal);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// å…³é—­èµ„æº</span></span><br><span class="line">            <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    rs.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (st != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    st.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    conn.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼š</p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566569819744.png"></p><h3 id="3-3-PreparedStatementçš„ä½¿ç”¨"><a href="#3-3-PreparedStatementçš„ä½¿ç”¨" class="headerlink" title="3.3 PreparedStatementçš„ä½¿ç”¨"></a>3.3 PreparedStatementçš„ä½¿ç”¨</h3><h4 id="3-3-1-PreparedStatementä»‹ç»"><a href="#3-3-1-PreparedStatementä»‹ç»" class="headerlink" title="3.3.1 PreparedStatementä»‹ç»"></a>3.3.1 PreparedStatementä»‹ç»</h4><ul><li><p>å¯ä»¥é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>preparedStatement(String sql)</strong> æ–¹æ³•è·å– PreparedStatement å¯¹è±¡</p></li><li><p><strong>PreparedStatement æ¥å£æ˜¯ Statement çš„å­æ¥å£ï¼Œå®ƒè¡¨ç¤ºä¸€æ¡é¢„ç¼–è¯‘è¿‡çš„ SQL è¯­å¥</strong></p></li><li><p>PreparedStatement å¯¹è±¡æ‰€ä»£è¡¨çš„ SQL è¯­å¥ä¸­çš„å‚æ•°ç”¨é—®å·(?)æ¥è¡¨ç¤ºï¼Œè°ƒç”¨ PreparedStatement å¯¹è±¡çš„ setXxx() æ–¹æ³•æ¥è®¾ç½®è¿™äº›å‚æ•°. setXxx() æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„ç´¢å¼•(ä» 1 å¼€å§‹)ï¼Œç¬¬äºŒä¸ªæ˜¯è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„å€¼</p></li></ul><h4 id="3-3-2-PreparedStatement-vs-Statement"><a href="#3-3-2-PreparedStatement-vs-Statement" class="headerlink" title="3.3.2 PreparedStatement vs Statement"></a>3.3.2 PreparedStatement vs Statement</h4><ul><li><p>ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p></li><li><p><strong>PreparedStatement èƒ½æœ€å¤§å¯èƒ½æé«˜æ€§èƒ½ï¼š</strong></p><ul><li>DBServerä¼šå¯¹<strong>é¢„ç¼–è¯‘</strong>è¯­å¥æä¾›æ€§èƒ½ä¼˜åŒ–ã€‚å› ä¸ºé¢„ç¼–è¯‘è¯­å¥æœ‰å¯èƒ½è¢«é‡å¤è°ƒç”¨ï¼Œæ‰€ä»¥<u>è¯­å¥åœ¨è¢«DBServerçš„ç¼–è¯‘å™¨ç¼–è¯‘åçš„æ‰§è¡Œä»£ç è¢«ç¼“å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆä¸‹æ¬¡è°ƒç”¨æ—¶åªè¦æ˜¯ç›¸åŒçš„é¢„ç¼–è¯‘è¯­å¥å°±ä¸éœ€è¦ç¼–è¯‘ï¼Œåªè¦å°†å‚æ•°ç›´æ¥ä¼ å…¥ç¼–è¯‘è¿‡çš„è¯­å¥æ‰§è¡Œä»£ç ä¸­å°±ä¼šå¾—åˆ°æ‰§è¡Œã€‚</u></li><li>åœ¨statementè¯­å¥ä¸­,å³ä½¿æ˜¯ç›¸åŒæ“ä½œä½†å› ä¸ºæ•°æ®å†…å®¹ä¸ä¸€æ ·,æ‰€ä»¥æ•´ä¸ªè¯­å¥æœ¬èº«ä¸èƒ½åŒ¹é…,æ²¡æœ‰ç¼“å­˜è¯­å¥çš„æ„ä¹‰.äº‹å®æ˜¯æ²¡æœ‰æ•°æ®åº“ä¼šå¯¹æ™®é€šè¯­å¥ç¼–è¯‘åçš„æ‰§è¡Œä»£ç ç¼“å­˜ã€‚è¿™æ ·<u>æ¯æ‰§è¡Œä¸€æ¬¡éƒ½è¦å¯¹ä¼ å…¥çš„è¯­å¥ç¼–è¯‘ä¸€æ¬¡ã€‚</u></li><li>(è¯­æ³•æ£€æŸ¥ï¼Œè¯­ä¹‰æ£€æŸ¥ï¼Œç¿»è¯‘æˆäºŒè¿›åˆ¶å‘½ä»¤ï¼Œç¼“å­˜)</li></ul></li><li><p>PreparedStatement å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥</p></li></ul><h4 id="3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"><a href="#3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨" class="headerlink" title="3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"></a>3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</h4><table><thead><tr><th>Javaç±»å‹</th><th>SQLç±»å‹</th></tr></thead><tbody><tr><td>boolean</td><td>BIT</td></tr><tr><td>byte</td><td>TINYINT</td></tr><tr><td>short</td><td>SMALLINT</td></tr><tr><td>int</td><td>INTEGER</td></tr><tr><td>long</td><td>BIGINT</td></tr><tr><td>String</td><td>CHAR,VARCHAR,LONGVARCHAR</td></tr><tr><td>byte array</td><td>BINARY , VAR BINARY</td></tr><tr><td>java.sql.Date</td><td>DATE</td></tr><tr><td>java.sql.Time</td><td>TIME</td></tr><tr><td>java.sql.Timestamp</td><td>TIMESTAMP</td></tr></tbody></table><h4 id="3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"><a href="#3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ" class="headerlink" title="3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"></a>3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é€šç”¨çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼ˆä½“ç°ä¸€ï¼šå¢ã€åˆ ã€æ”¹ ï¼› ä½“ç°äºŒï¼šé’ˆå¯¹äºä¸åŒçš„è¡¨ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String sql,Object ... args)</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.è·å–æ•°æ®åº“çš„è¿æ¥</span></span><br><span class="line">        conn = JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span></span><br><span class="line">        ps = conn.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//3.å¡«å……å ä½ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i &lt; args.length;i++)&#123;</span><br><span class="line">            ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.æ‰§è¡Œsqlè¯­å¥</span></span><br><span class="line">        ps.execute();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">        <span class="comment">//5.å…³é—­èµ„æº</span></span><br><span class="line">        JDBCUtils.closeResource(conn, ps);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"><a href="#3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ" class="headerlink" title="3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"></a>3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šç”¨çš„é’ˆå¯¹äºä¸åŒè¡¨çš„æŸ¥è¯¢:è¿”å›ä¸€ä¸ªå¯¹è±¡ (version 1.0)</span></span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; T <span class="title function_">getInstance</span><span class="params">(Class&lt;T&gt; clazz, String sql, Object... args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        conn = JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.é¢„ç¼–è¯‘sqlè¯­å¥ï¼Œå¾—åˆ°PreparedStatementå¯¹è±¡</span></span><br><span class="line">        ps = conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.å¡«å……å ä½ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.æ‰§è¡ŒexecuteQuery(),å¾—åˆ°ç»“æœé›†ï¼šResultSet</span></span><br><span class="line">        rs = ps.executeQuery();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5.å¾—åˆ°ç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData</span></span><br><span class="line">        <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6.1é€šè¿‡ResultSetMetaDataå¾—åˆ°columnCount,columnLabelï¼›é€šè¿‡ResultSetå¾—åˆ°åˆ—å€¼</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">        <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">            <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++) &#123;<span class="comment">// éå†æ¯ä¸€ä¸ªåˆ—</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// è·å–åˆ—å€¼</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">columnVal</span> <span class="operator">=</span> rs.getObject(i + <span class="number">1</span>);</span><br><span class="line">                <span class="comment">// è·å–åˆ—çš„åˆ«å:åˆ—çš„åˆ«åï¼Œä½¿ç”¨ç±»çš„å±æ€§åå……å½“</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">columnLabel</span> <span class="operator">=</span> rsmd.getColumnLabel(i + <span class="number">1</span>);</span><br><span class="line">                <span class="comment">// 6.2ä½¿ç”¨åå°„ï¼Œç»™å¯¹è±¡çš„ç›¸åº”å±æ€§èµ‹å€¼</span></span><br><span class="line">                <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(columnLabel);</span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                field.set(t, columnVal);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 7.å…³é—­èµ„æº</span></span><br><span class="line">        JDBCUtils.closeResource(conn, ps, rs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨PreparedStatementå®ç°çš„æŸ¥è¯¢æ“ä½œå¯ä»¥æ›¿æ¢Statementå®ç°çš„æŸ¥è¯¢æ“ä½œï¼Œè§£å†³Statementæ‹¼ä¸²å’ŒSQLæ³¨å…¥é—®é¢˜ã€‚</p></blockquote><h3 id="3-4-ResultSetä¸ResultSetMetaData"><a href="#3-4-ResultSetä¸ResultSetMetaData" class="headerlink" title="3.4 ResultSetä¸ResultSetMetaData"></a>3.4 ResultSetä¸ResultSetMetaData</h3><h4 id="3-4-1-ResultSet"><a href="#3-4-1-ResultSet" class="headerlink" title="3.4.1 ResultSet"></a>3.4.1 ResultSet</h4><ul><li><p>æŸ¥è¯¢éœ€è¦è°ƒç”¨PreparedStatement çš„ executeQuery() æ–¹æ³•ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ä¸€ä¸ªResultSet å¯¹è±¡</p></li><li><p>ResultSet å¯¹è±¡ä»¥é€»è¾‘è¡¨æ ¼çš„å½¢å¼å°è£…äº†æ‰§è¡Œæ•°æ®åº“æ“ä½œçš„ç»“æœé›†ï¼ŒResultSet æ¥å£ç”±æ•°æ®åº“å‚å•†æä¾›å®ç°</p></li><li><p>ResultSet è¿”å›çš„å®é™…ä¸Šå°±æ˜¯ä¸€å¼ æ•°æ®è¡¨ã€‚æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ•°æ®è¡¨çš„ç¬¬ä¸€æ¡è®°å½•çš„å‰é¢ã€‚</p></li><li><p>ResultSet å¯¹è±¡ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘å½“å‰æ•°æ®è¡Œçš„<strong>æ¸¸æ ‡</strong>ï¼Œåˆå§‹çš„æ—¶å€™ï¼Œæ¸¸æ ‡åœ¨ç¬¬ä¸€è¡Œä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ ResultSet å¯¹è±¡çš„ next() æ–¹æ³•ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œã€‚è°ƒç”¨ next()æ–¹æ³•æ£€æµ‹ä¸‹ä¸€è¡Œæ˜¯å¦æœ‰æ•ˆã€‚è‹¥æœ‰æ•ˆï¼Œè¯¥æ–¹æ³•è¿”å› trueï¼Œä¸”æŒ‡é’ˆä¸‹ç§»ã€‚ç›¸å½“äºIteratorå¯¹è±¡çš„ hasNext() å’Œ next() æ–¹æ³•çš„ç»“åˆä½“ã€‚</p></li><li><p>å½“æŒ‡é’ˆæŒ‡å‘ä¸€è¡Œæ—¶, å¯ä»¥é€šè¿‡è°ƒç”¨ getXxx(int index) æˆ– getXxx(int columnName) è·å–æ¯ä¸€åˆ—çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚: getInt(1), getString(â€œnameâ€)</li><li><strong>æ³¨æ„ï¼šJavaä¸æ•°æ®åº“äº¤äº’æ¶‰åŠåˆ°çš„ç›¸å…³Java APIä¸­çš„ç´¢å¼•éƒ½ä»1å¼€å§‹ã€‚</strong></li></ul></li><li><p>ResultSet æ¥å£çš„å¸¸ç”¨æ–¹æ³•ï¼š</p><ul><li><p>boolean next()</p></li><li><p>getString()</p></li><li><p>â€¦</p></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580152530.png"></p></li></ul><h4 id="3-4-2-ResultSetMetaData"><a href="#3-4-2-ResultSetMetaData" class="headerlink" title="3.4.2 ResultSetMetaData"></a>3.4.2 ResultSetMetaData</h4><ul><li><p>å¯ç”¨äºè·å–å…³äº ResultSet å¯¹è±¡ä¸­åˆ—çš„ç±»å‹å’Œå±æ€§ä¿¡æ¯çš„å¯¹è±¡</p></li><li><p>ResultSetMetaData meta &#x3D; rs.getMetaData();</p><ul><li><p><strong>getColumnName</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åç§°</p></li><li><p><strong>getColumnLabel</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åˆ«å</p></li><li><p><strong>getColumnCount</strong>()ï¼šè¿”å›å½“å‰ ResultSet å¯¹è±¡ä¸­çš„åˆ—æ•°ã€‚</p></li><li><p>getColumnTypeName(int column)ï¼šæ£€ç´¢æŒ‡å®šåˆ—çš„æ•°æ®åº“ç‰¹å®šçš„ç±»å‹åç§°ã€‚</p></li><li><p>getColumnDisplaySize(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—çš„æœ€å¤§æ ‡å‡†å®½åº¦ï¼Œä»¥å­—ç¬¦ä¸ºå•ä½ã€‚</p></li><li><p><strong>isNullable</strong>(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—ä¸­çš„å€¼æ˜¯å¦å¯ä»¥ä¸º nullã€‚</p></li><li><p>isAutoIncrement(int column)ï¼šæŒ‡ç¤ºæ˜¯å¦è‡ªåŠ¨ä¸ºæŒ‡å®šåˆ—è¿›è¡Œç¼–å·ï¼Œè¿™æ ·è¿™äº›åˆ—ä»ç„¶æ˜¯åªè¯»çš„ã€‚</p></li></ul></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555579494691.png"></p><p><strong>é—®é¢˜1ï¼šå¾—åˆ°ç»“æœé›†å, å¦‚ä½•çŸ¥é“è¯¥ç»“æœé›†ä¸­æœ‰å“ªäº›åˆ— ï¼Ÿ åˆ—åæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>â€‹ éœ€è¦ä½¿ç”¨ä¸€ä¸ªæè¿° ResultSet çš„å¯¹è±¡ï¼Œ å³ ResultSetMetaData</p><p><strong>é—®é¢˜2ï¼šå…³äºResultSetMetaData</strong></p><ol><li><strong>å¦‚ä½•è·å– ResultSetMetaData</strong>ï¼š è°ƒç”¨ ResultSet çš„ getMetaData() æ–¹æ³•å³å¯</li><li><strong>è·å– ResultSet ä¸­æœ‰å¤šå°‘åˆ—</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„ getColumnCount() æ–¹æ³•</li><li><strong>è·å– ResultSet æ¯ä¸€åˆ—çš„åˆ—çš„åˆ«åæ˜¯ä»€ä¹ˆ</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„getColumnLabel() æ–¹æ³•</li></ol><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555579816884.png"></p><h3 id="3-5-èµ„æºçš„é‡Šæ”¾"><a href="#3-5-èµ„æºçš„é‡Šæ”¾" class="headerlink" title="3.5 èµ„æºçš„é‡Šæ”¾"></a>3.5 èµ„æºçš„é‡Šæ”¾</h3><ul><li>é‡Šæ”¾ResultSet, Statement,Connectionã€‚</li><li>æ•°æ®åº“è¿æ¥ï¼ˆConnectionï¼‰æ˜¯éå¸¸ç¨€æœ‰çš„èµ„æºï¼Œç”¨å®Œåå¿…é¡»é©¬ä¸Šé‡Šæ”¾ï¼Œå¦‚æœConnectionä¸èƒ½åŠæ—¶æ­£ç¡®çš„å…³é—­å°†å¯¼è‡´ç³»ç»Ÿå®•æœºã€‚Connectionçš„ä½¿ç”¨åŸåˆ™æ˜¯<strong>å°½é‡æ™šåˆ›å»ºï¼Œå°½é‡æ—©çš„é‡Šæ”¾ã€‚</strong></li><li>å¯ä»¥åœ¨finallyä¸­å…³é—­ï¼Œä¿è¯åŠæ—¶å…¶ä»–ä»£ç å‡ºç°å¼‚å¸¸ï¼Œèµ„æºä¹Ÿä¸€å®šèƒ½è¢«å…³é—­ã€‚</li></ul><h3 id="3-6-JDBC-APIå°ç»“"><a href="#3-6-JDBC-APIå°ç»“" class="headerlink" title="3.6 JDBC APIå°ç»“"></a>3.6 JDBC APIå°ç»“</h3><ul><li><p>ä¸¤ç§æ€æƒ³</p><ul><li><p>é¢å‘æ¥å£ç¼–ç¨‹çš„æ€æƒ³</p></li><li><p>ORMæ€æƒ³(object relational mapping)</p><ul><li>ä¸€ä¸ªæ•°æ®è¡¨å¯¹åº”ä¸€ä¸ªjavaç±»</li><li>è¡¨ä¸­çš„ä¸€æ¡è®°å½•å¯¹åº”javaç±»çš„ä¸€ä¸ªå¯¹è±¡</li><li>è¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µå¯¹åº”javaç±»çš„ä¸€ä¸ªå±æ€§</li></ul></li></ul><blockquote><p>sqlæ˜¯éœ€è¦ç»“åˆåˆ—åå’Œè¡¨çš„å±æ€§åæ¥å†™ã€‚æ³¨æ„èµ·åˆ«åã€‚</p></blockquote></li><li><p>ä¸¤ç§æŠ€æœ¯</p><ul><li>JDBCç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData<ul><li>è·å–åˆ—æ•°ï¼šgetColumnCount()</li><li>è·å–åˆ—çš„åˆ«åï¼šgetColumnLabel()</li></ul></li><li>é€šè¿‡åå°„ï¼Œåˆ›å»ºæŒ‡å®šç±»çš„å¯¹è±¡ï¼Œè·å–æŒ‡å®šçš„å±æ€§å¹¶èµ‹å€¼</li></ul></li></ul><hr><h2 id="ç« èŠ‚ç»ƒä¹ "><a href="#ç« èŠ‚ç»ƒä¹ " class="headerlink" title="ç« èŠ‚ç»ƒä¹ "></a>ç« èŠ‚ç»ƒä¹ </h2><p><strong>ç»ƒä¹ é¢˜1ï¼šä»æ§åˆ¶å°å‘æ•°æ®åº“çš„è¡¨customersä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580275036.png"></p><p><strong>ç»ƒä¹ é¢˜2ï¼šåˆ›ç«‹æ•°æ®åº“è¡¨ examstudentï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580735377.png"></p><p>å‘æ•°æ®è¡¨ä¸­æ·»åŠ å¦‚ä¸‹æ•°æ®ï¼š</p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580763636.png"></p><p><strong>ä»£ç å®ç°1ï¼šæ’å…¥ä¸€ä¸ªæ–°çš„student ä¿¡æ¯</strong></p><p>è¯·è¾“å…¥è€ƒç”Ÿçš„è¯¦ç»†ä¿¡æ¯</p><p>Type:<br>IDCard:<br>ExamCard:<br>StudentName:<br>Location:<br>Grade:</p><p>ä¿¡æ¯å½•å…¥æˆåŠŸ!</p><p><strong>ä»£ç å®ç°2ï¼šåœ¨ eclipseä¸­å»ºç«‹ java ç¨‹åºï¼šè¾“å…¥èº«ä»½è¯å·æˆ–å‡†è€ƒè¯å·å¯ä»¥æŸ¥è¯¢åˆ°å­¦ç”Ÿçš„åŸºæœ¬ä¿¡æ¯ã€‚ç»“æœå¦‚ä¸‹ï¼š</strong></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580937490.png"></p><p><strong>ä»£ç å®ç°3ï¼šå®Œæˆå­¦ç”Ÿä¿¡æ¯çš„åˆ é™¤åŠŸèƒ½</strong></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555580965019.png"></p><hr><h2 id="ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ"><a href="#ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ" class="headerlink" title="ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ"></a>ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</h2><h3 id="4-1-MySQL-BLOBç±»å‹"><a href="#4-1-MySQL-BLOBç±»å‹" class="headerlink" title="4.1 MySQL BLOBç±»å‹"></a>4.1 MySQL BLOBç±»å‹</h3><ul><li><p>MySQLä¸­ï¼ŒBLOBæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤§é‡æ•°æ®çš„å®¹å™¨ï¼Œå®ƒèƒ½å®¹çº³ä¸åŒå¤§å°çš„æ•°æ®ã€‚</p></li><li><p>æ’å…¥BLOBç±»å‹çš„æ•°æ®å¿…é¡»ä½¿ç”¨PreparedStatementï¼Œå› ä¸ºBLOBç±»å‹çš„æ•°æ®æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å†™çš„ã€‚</p></li><li><p>MySQLçš„å››ç§BLOBç±»å‹(é™¤äº†åœ¨å­˜å‚¨çš„æœ€å¤§ä¿¡æ¯é‡ä¸Šä¸åŒå¤–ï¼Œä»–ä»¬æ˜¯ç­‰åŒçš„)</p></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555581069798.png"></p><ul><li>å®é™…ä½¿ç”¨ä¸­æ ¹æ®éœ€è¦å­˜å…¥çš„æ•°æ®å¤§å°å®šä¹‰ä¸åŒçš„BLOBç±»å‹ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœå­˜å‚¨çš„æ–‡ä»¶è¿‡å¤§ï¼Œæ•°æ®åº“çš„æ€§èƒ½ä¼šä¸‹é™ã€‚</li><li>å¦‚æœåœ¨æŒ‡å®šäº†ç›¸å…³çš„Blobç±»å‹ä»¥åï¼Œè¿˜æŠ¥é”™ï¼šxxx too largeï¼Œé‚£ä¹ˆåœ¨mysqlçš„å®‰è£…ç›®å½•ä¸‹ï¼Œæ‰¾my.iniæ–‡ä»¶åŠ ä¸Šå¦‚ä¸‹çš„é…ç½®å‚æ•°ï¼š <strong>max_allowed_packet&#x3D;16M</strong>ã€‚åŒæ—¶æ³¨æ„ï¼šä¿®æ”¹äº†my.iniæ–‡ä»¶ä¹‹åï¼Œéœ€è¦é‡æ–°å¯åŠ¨mysqlæœåŠ¡ã€‚</li></ul><h3 id="4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"><a href="#4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"></a>4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–è¿æ¥</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into customers(name,email,birth,photo)values(?,?,?,?)&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¡«å……å ä½ç¬¦</span></span><br><span class="line">ps.setString(<span class="number">1</span>, <span class="string">&quot;å¾æµ·å¼º&quot;</span>);</span><br><span class="line">ps.setString(<span class="number">2</span>, <span class="string">&quot;xhq@126.com&quot;</span>);</span><br><span class="line">ps.setDate(<span class="number">3</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="keyword">new</span> <span class="title class_">java</span>.util.Date().getTime()));</span><br><span class="line"><span class="comment">// æ“ä½œBlobç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;xhq.png&quot;</span>);</span><br><span class="line">ps.setBlob(<span class="number">4</span>, fis);</span><br><span class="line"><span class="comment">//æ‰§è¡Œ</span></span><br><span class="line">ps.execute();</span><br><span class="line"></span><br><span class="line">fis.close();</span><br><span class="line">JDBCUtils.closeResource(conn, ps);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"><a href="#4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ" class="headerlink" title="4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"></a>4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update customers set photo = ? where id = ?&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¡«å……å ä½ç¬¦</span></span><br><span class="line"><span class="comment">// æ“ä½œBlobç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;coffee.png&quot;</span>);</span><br><span class="line">ps.setBlob(<span class="number">1</span>, fis);</span><br><span class="line">ps.setInt(<span class="number">2</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line">ps.execute();</span><br><span class="line"></span><br><span class="line">fis.close();</span><br><span class="line">JDBCUtils.closeResource(conn, ps);</span><br></pre></td></tr></table></figure><h3 id="4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"><a href="#4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"></a>4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT id, name, email, birth, photo FROM customer WHERE id = ?&quot;</span>;</span><br><span class="line">conn = getConnection();</span><br><span class="line">ps = conn.prepareStatement(sql);</span><br><span class="line">ps.setInt(<span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line">rs = ps.executeQuery();</span><br><span class="line"><span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="number">1</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="number">2</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> rs.getString(<span class="number">3</span>);</span><br><span class="line">    <span class="type">Date</span> <span class="variable">birth</span> <span class="operator">=</span> rs.getDate(<span class="number">4</span>);</span><br><span class="line">    <span class="type">Customer</span> <span class="variable">cust</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>(id, name, email, birth);</span><br><span class="line">    System.out.println(cust); </span><br><span class="line">    <span class="comment">//è¯»å–Blobç±»å‹çš„å­—æ®µ</span></span><br><span class="line">    <span class="type">Blob</span> <span class="variable">photo</span> <span class="operator">=</span> rs.getBlob(<span class="number">5</span>);</span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> photo.getBinaryStream();</span><br><span class="line">    <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;c.jpg&quot;</span>);</span><br><span class="line">    <span class="type">byte</span> [] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((len = is.read(buffer)) != -<span class="number">1</span>)&#123;</span><br><span class="line">        os.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">    &#125;</span><br><span class="line">    JDBCUtils.closeResource(conn, ps, rs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(is != <span class="literal">null</span>)&#123;</span><br><span class="line">        is.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(os !=  <span class="literal">null</span>)&#123;</span><br><span class="line">        os.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¬¬5ç« -æ‰¹é‡æ’å…¥"><a href="#ç¬¬5ç« -æ‰¹é‡æ’å…¥" class="headerlink" title="ç¬¬5ç«  æ‰¹é‡æ’å…¥"></a>ç¬¬5ç«  æ‰¹é‡æ’å…¥</h2><h3 id="5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"><a href="#5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥" class="headerlink" title="5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"></a>5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</h3><p>å½“éœ€è¦æˆæ‰¹æ’å…¥æˆ–è€…æ›´æ–°è®°å½•æ—¶ï¼Œå¯ä»¥é‡‡ç”¨Javaçš„æ‰¹é‡<strong>æ›´æ–°</strong>æœºåˆ¶ï¼Œè¿™ä¸€æœºåˆ¶å…è®¸å¤šæ¡è¯­å¥ä¸€æ¬¡æ€§æäº¤ç»™æ•°æ®åº“æ‰¹é‡å¤„ç†ã€‚é€šå¸¸æƒ…å†µä¸‹æ¯”å•ç‹¬æäº¤å¤„ç†æ›´æœ‰æ•ˆç‡</p><p>JDBCçš„æ‰¹é‡å¤„ç†è¯­å¥åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>addBatch(String)ï¼šæ·»åŠ éœ€è¦æ‰¹é‡å¤„ç†çš„SQLè¯­å¥æˆ–æ˜¯å‚æ•°ï¼›</strong></li><li><strong>executeBatch()ï¼šæ‰§è¡Œæ‰¹é‡å¤„ç†è¯­å¥ï¼›</strong></li><li><strong>clearBatch():æ¸…ç©ºç¼“å­˜çš„æ•°æ®</strong></li></ul><p>é€šå¸¸æˆ‘ä»¬ä¼šé‡åˆ°ä¸¤ç§æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥çš„æƒ…å†µï¼š</p><ul><li>å¤šæ¡SQLè¯­å¥çš„æ‰¹é‡å¤„ç†ï¼›</li><li>ä¸€ä¸ªSQLè¯­å¥çš„æ‰¹é‡ä¼ å‚ï¼›</li></ul><h3 id="5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"><a href="#5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥" class="headerlink" title="5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"></a>5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</h3><p>ä¸¾ä¾‹ï¼šå‘æ•°æ®è¡¨ä¸­æ’å…¥20000æ¡æ•°æ®</p><ul><li>æ•°æ®åº“ä¸­æä¾›ä¸€ä¸ªgoodsè¡¨ã€‚åˆ›å»ºå¦‚ä¸‹ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> goods(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">NAME <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"><a href="#5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement" class="headerlink" title="5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"></a>5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"><span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i &lt;= <span class="number">20000</span>;i++)&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into goods(name) values(&#x27;name_&#x27; + &quot;</span>+ i +<span class="string">&quot;)&quot;</span>;</span><br><span class="line">    st.executeUpdate(sql);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"><a href="#5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement" class="headerlink" title="5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"></a>5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into goods(name)values(?)&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i &lt;= <span class="number">20000</span>;i++)&#123;</span><br><span class="line">    ps.setString(<span class="number">1</span>, <span class="string">&quot;name_&quot;</span> + i);</span><br><span class="line">    ps.executeUpdate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">&quot;èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š&quot;</span> + (end - start));<span class="comment">//82340</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JDBCUtils.closeResource(conn, ps);</span><br></pre></td></tr></table></figure><h4 id="5-2-3-å®ç°å±‚æ¬¡ä¸‰"><a href="#5-2-3-å®ç°å±‚æ¬¡ä¸‰" class="headerlink" title="5.2.3 å®ç°å±‚æ¬¡ä¸‰"></a>5.2.3 å®ç°å±‚æ¬¡ä¸‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ä¿®æ”¹1ï¼š ä½¿ç”¨ addBatch() / executeBatch() / clearBatch()</span></span><br><span class="line"><span class="comment"> * ä¿®æ”¹2ï¼šmysqlæœåŠ¡å™¨é»˜è®¤æ˜¯å…³é—­æ‰¹å¤„ç†çš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªå‚æ•°ï¼Œè®©mysqlå¼€å¯æ‰¹å¤„ç†çš„æ”¯æŒã€‚</span></span><br><span class="line"><span class="comment"> *          ?rewriteBatchedStatements=true å†™åœ¨é…ç½®æ–‡ä»¶çš„urlåé¢</span></span><br><span class="line"><span class="comment"> * ä¿®æ”¹3ï¼šä½¿ç”¨æ›´æ–°çš„mysql é©±åŠ¨ï¼šmysql-connector-java-5.1.37-bin.jar</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into goods(name)values(?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i &lt;= <span class="number">1000000</span>;i++)&#123;</span><br><span class="line">        ps.setString(<span class="number">1</span>, <span class="string">&quot;name_&quot;</span> + i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.â€œæ”’â€sql</span></span><br><span class="line">        ps.addBatch();</span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">500</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//2.æ‰§è¡Œ</span></span><br><span class="line">            ps.executeBatch();</span><br><span class="line">            <span class="comment">//3.æ¸…ç©º</span></span><br><span class="line">            ps.clearBatch();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š&quot;</span> + (end - start));<span class="comment">//20000æ¡ï¼š625                                                                         //1000000æ¡:14733  </span></span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, ps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-4-å®ç°å±‚æ¬¡å››"><a href="#5-2-4-å®ç°å±‚æ¬¡å››" class="headerlink" title="5.2.4 å®ç°å±‚æ¬¡å››"></a>5.2.4 å®ç°å±‚æ¬¡å››</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* å±‚æ¬¡å››ï¼šåœ¨å±‚æ¬¡ä¸‰çš„åŸºç¡€ä¸Šæ“ä½œ</span></span><br><span class="line"><span class="comment">* ä½¿ç”¨Connection çš„ setAutoCommit(false)  /  commit()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert2</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.è®¾ç½®ä¸ºä¸è‡ªåŠ¨æäº¤æ•°æ®</span></span><br><span class="line">    conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into goods(name)values(?)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i &lt;= <span class="number">1000000</span>;i++)&#123;</span><br><span class="line">        ps.setString(<span class="number">1</span>, <span class="string">&quot;name_&quot;</span> + i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.â€œæ”’â€sql</span></span><br><span class="line">        ps.addBatch();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">500</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//2.æ‰§è¡Œ</span></span><br><span class="line">            ps.executeBatch();</span><br><span class="line">            <span class="comment">//3.æ¸…ç©º</span></span><br><span class="line">            ps.clearBatch();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.æäº¤æ•°æ®</span></span><br><span class="line">    conn.commit();</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š&quot;</span> + (end - start));<span class="comment">//1000000æ¡:4978 </span></span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, ps);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡"><a href="#ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡" class="headerlink" title="ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡"></a>ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</h2><h3 id="6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»"><a href="#6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»" class="headerlink" title="6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»"></a>6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</h3><ul><li><p><strong>äº‹åŠ¡ï¼šä¸€ç»„é€»è¾‘æ“ä½œå•å…ƒ,ä½¿æ•°æ®ä»ä¸€ç§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚</strong></p></li><li><p><strong>äº‹åŠ¡å¤„ç†ï¼ˆäº‹åŠ¡æ“ä½œï¼‰ï¼š</strong>ä¿è¯æ‰€æœ‰äº‹åŠ¡éƒ½ä½œä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒæ¥æ‰§è¡Œï¼Œå³ä½¿å‡ºç°äº†æ•…éšœï¼Œéƒ½ä¸èƒ½æ”¹å˜è¿™ç§æ‰§è¡Œæ–¹å¼ã€‚å½“åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œå¤šä¸ªæ“ä½œæ—¶ï¼Œè¦ä¹ˆæ‰€æœ‰çš„äº‹åŠ¡éƒ½**è¢«æäº¤(commit)<strong>ï¼Œé‚£ä¹ˆè¿™äº›ä¿®æ”¹å°±æ°¸ä¹…åœ°ä¿å­˜ä¸‹æ¥ï¼›è¦ä¹ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿå°†æ”¾å¼ƒæ‰€ä½œçš„æ‰€æœ‰ä¿®æ”¹ï¼Œæ•´ä¸ªäº‹åŠ¡</strong>å›æ»š(rollback)**åˆ°æœ€åˆçŠ¶æ€ã€‚</p></li><li><p>ä¸ºç¡®ä¿æ•°æ®åº“ä¸­æ•°æ®çš„<strong>ä¸€è‡´æ€§</strong>ï¼Œæ•°æ®çš„æ“çºµåº”å½“æ˜¯ç¦»æ•£çš„æˆç»„çš„é€»è¾‘å•å…ƒï¼šå½“å®ƒå…¨éƒ¨å®Œæˆæ—¶ï¼Œæ•°æ®çš„ä¸€è‡´æ€§å¯ä»¥ä¿æŒï¼Œè€Œå½“è¿™ä¸ªå•å…ƒä¸­çš„ä¸€éƒ¨åˆ†æ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡åº”å…¨éƒ¨è§†ä¸ºé”™è¯¯ï¼Œæ‰€æœ‰ä»èµ·å§‹ç‚¹ä»¥åçš„æ“ä½œåº”å…¨éƒ¨å›é€€åˆ°å¼€å§‹çŠ¶æ€ã€‚</p></li></ul><h3 id="6-2-JDBCäº‹åŠ¡å¤„ç†"><a href="#6-2-JDBCäº‹åŠ¡å¤„ç†" class="headerlink" title="6.2 JDBCäº‹åŠ¡å¤„ç†"></a>6.2 JDBCäº‹åŠ¡å¤„ç†</h3><ul><li><p>æ•°æ®ä¸€æ—¦æäº¤ï¼Œå°±ä¸å¯å›æ»šã€‚</p></li><li><p>æ•°æ®ä»€ä¹ˆæ—¶å€™æ„å‘³ç€æäº¤ï¼Ÿ</p><ul><li><strong>å½“ä¸€ä¸ªè¿æ¥å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡</strong>ï¼šæ¯æ¬¡æ‰§è¡Œä¸€ä¸ª SQL è¯­å¥æ—¶ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šå‘æ•°æ®åº“è‡ªåŠ¨æäº¤ï¼Œè€Œä¸èƒ½å›æ»šã€‚</li><li><strong>å…³é—­æ•°æ®åº“è¿æ¥ï¼Œæ•°æ®å°±ä¼šè‡ªåŠ¨çš„æäº¤ã€‚</strong>å¦‚æœå¤šä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œä½¿ç”¨çš„æ˜¯è‡ªå·±å•ç‹¬çš„è¿æ¥ï¼Œåˆ™æ— æ³•ä¿è¯äº‹åŠ¡ã€‚å³åŒä¸€ä¸ªäº‹åŠ¡çš„å¤šä¸ªæ“ä½œå¿…é¡»åœ¨åŒä¸€ä¸ªè¿æ¥ä¸‹ã€‚</li></ul></li><li><p><strong>JDBCç¨‹åºä¸­ä¸ºäº†è®©å¤šä¸ª SQL è¯­å¥ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œï¼š</strong></p><ul><li>è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>setAutoCommit(false);</strong> ä»¥å–æ¶ˆè‡ªåŠ¨æäº¤äº‹åŠ¡</li><li>åœ¨æ‰€æœ‰çš„ SQL è¯­å¥éƒ½æˆåŠŸæ‰§è¡Œåï¼Œè°ƒç”¨ <strong>commit();</strong> æ–¹æ³•æäº¤äº‹åŠ¡</li><li>åœ¨å‡ºç°å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨ <strong>rollback();</strong> æ–¹æ³•å›æ»šäº‹åŠ¡</li></ul><blockquote><p>è‹¥æ­¤æ—¶ Connection æ²¡æœ‰è¢«å…³é—­ï¼Œè¿˜å¯èƒ½è¢«é‡å¤ä½¿ç”¨ï¼Œåˆ™éœ€è¦æ¢å¤å…¶è‡ªåŠ¨æäº¤çŠ¶æ€ setAutoCommit(true)ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯æ—¶ï¼Œæ‰§è¡Œclose()æ–¹æ³•å‰ï¼Œå»ºè®®æ¢å¤è‡ªåŠ¨æäº¤çŠ¶æ€ã€‚</p></blockquote></li></ul><p>ã€æ¡ˆä¾‹ï¼šç”¨æˆ·AAå‘ç”¨æˆ·BBè½¬è´¦100ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testJDBCTransaction</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–æ•°æ®åº“è¿æ¥</span></span><br><span class="line">        conn = JDBCUtils.getConnection();</span><br><span class="line">        <span class="comment">// 2.å¼€å¯äº‹åŠ¡</span></span><br><span class="line">        conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// 3.è¿›è¡Œæ•°æ®åº“æ“ä½œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;update user_table set balance = balance - 100 where user = ?&quot;</span>;</span><br><span class="line">        update(conn, sql1, <span class="string">&quot;AA&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸</span></span><br><span class="line">        <span class="comment">//System.out.println(10 / 0);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update user_table set balance = balance + 100 where user = ?&quot;</span>;</span><br><span class="line">        update(conn, sql2, <span class="string">&quot;BB&quot;</span>);</span><br><span class="line">        <span class="comment">// 4.è‹¥æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™æäº¤äº‹åŠ¡</span></span><br><span class="line">        conn.commit();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="comment">// 5.è‹¥æœ‰å¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn.rollback();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e1) &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//6.æ¢å¤æ¯æ¬¡DMLæ“ä½œçš„è‡ªåŠ¨æäº¤åŠŸèƒ½</span></span><br><span class="line">            conn.setAutoCommit(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//7.å…³é—­è¿æ¥</span></span><br><span class="line">        JDBCUtils.closeResource(conn, <span class="literal">null</span>, <span class="literal">null</span>); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œå¯¹æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨äº‹åŠ¡ä»¥åçš„é€šç”¨çš„å¢åˆ æ”¹æ“ä½œï¼ˆversion 2.0ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Connection conn ,String sql, Object... args)</span> &#123;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span></span><br><span class="line">        ps = conn.prepareStatement(sql);</span><br><span class="line">        <span class="comment">// 2.å¡«å……å ä½ç¬¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            ps.setObject(i + <span class="number">1</span>, args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œsqlè¯­å¥</span></span><br><span class="line">        ps.execute();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 4.å…³é—­èµ„æº</span></span><br><span class="line">        JDBCUtils.closeResource(<span class="literal">null</span>, ps);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-3-äº‹åŠ¡çš„ACIDå±æ€§"><a href="#6-3-äº‹åŠ¡çš„ACIDå±æ€§" class="headerlink" title="6.3 äº‹åŠ¡çš„ACIDå±æ€§"></a>6.3 äº‹åŠ¡çš„ACIDå±æ€§</h3><ol><li><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong><br>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚</p></li><li><p><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong><br>äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p></li><li><p><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong><br>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</p></li><li><p><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong><br>æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥çš„å…¶ä»–æ“ä½œå’Œæ•°æ®åº“æ•…éšœä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</p></li></ol><h4 id="6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"><a href="#6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜" class="headerlink" title="6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"></a>6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</h4><ul><li><p>å¯¹äºåŒæ—¶è¿è¡Œçš„å¤šä¸ªäº‹åŠ¡, å½“è¿™äº›äº‹åŠ¡è®¿é—®æ•°æ®åº“ä¸­ç›¸åŒçš„æ•°æ®æ—¶, å¦‚æœæ²¡æœ‰é‡‡å–å¿…è¦çš„éš”ç¦»æœºåˆ¶, å°±ä¼šå¯¼è‡´å„ç§å¹¶å‘é—®é¢˜:</p><ul><li><strong>è„è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 è¯»å–äº†å·²ç»è¢« T2 æ›´æ–°ä½†è¿˜<strong>æ²¡æœ‰è¢«æäº¤</strong>çš„å­—æ®µã€‚ä¹‹å, è‹¥ T2 å›æ»š, T1è¯»å–çš„å†…å®¹å°±æ˜¯ä¸´æ—¶ä¸”æ— æ•ˆçš„ã€‚</li><li><strong>ä¸å¯é‡å¤è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 <strong>æ›´æ–°</strong>äº†è¯¥å­—æ®µã€‚ä¹‹å, T1å†æ¬¡è¯»å–åŒä¸€ä¸ªå­—æ®µ, å€¼å°±ä¸åŒäº†ã€‚</li><li><strong>å¹»è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 åœ¨è¯¥è¡¨ä¸­<strong>æ’å…¥</strong>äº†ä¸€äº›æ–°çš„è¡Œã€‚ä¹‹å, å¦‚æœ T1 å†æ¬¡è¯»å–åŒä¸€ä¸ªè¡¨, å°±ä¼šå¤šå‡ºå‡ è¡Œã€‚</li></ul></li><li><p><strong>æ•°æ®åº“äº‹åŠ¡çš„éš”ç¦»æ€§</strong>: æ•°æ®åº“ç³»ç»Ÿå¿…é¡»å…·æœ‰éš”ç¦»å¹¶å‘è¿è¡Œå„ä¸ªäº‹åŠ¡çš„èƒ½åŠ›, ä½¿å®ƒä»¬ä¸ä¼šç›¸äº’å½±å“, é¿å…å„ç§å¹¶å‘é—®é¢˜ã€‚</p></li><li><p>ä¸€ä¸ªäº‹åŠ¡ä¸å…¶ä»–äº‹åŠ¡éš”ç¦»çš„ç¨‹åº¦ç§°ä¸ºéš”ç¦»çº§åˆ«ã€‚æ•°æ®åº“è§„å®šäº†å¤šç§äº‹åŠ¡éš”ç¦»çº§åˆ«, ä¸åŒéš”ç¦»çº§åˆ«å¯¹åº”ä¸åŒçš„å¹²æ‰°ç¨‹åº¦, <strong>éš”ç¦»çº§åˆ«è¶Šé«˜, æ•°æ®ä¸€è‡´æ€§å°±è¶Šå¥½, ä½†å¹¶å‘æ€§è¶Šå¼±ã€‚</strong></p></li></ul><h4 id="6-3-2-å››ç§éš”ç¦»çº§åˆ«"><a href="#6-3-2-å››ç§éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.2 å››ç§éš”ç¦»çº§åˆ«"></a>6.3.2 å››ç§éš”ç¦»çº§åˆ«</h4><ul><li><p>æ•°æ®åº“æä¾›çš„4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š<br><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555586275271.png"></p></li><li><p>Oracle æ”¯æŒçš„ 2 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š<strong>READ COMMITED</strong>, SERIALIZABLEã€‚ Oracle é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>READ COMMITED</strong> ã€‚</p></li><li><p>Mysql æ”¯æŒ 4 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚Mysql é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>REPEATABLE READã€‚</strong></p></li></ul><h4 id="6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"><a href="#6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"></a>6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</h4><ul><li><p>æ¯å¯åŠ¨ä¸€ä¸ª mysql ç¨‹åº, å°±ä¼šè·å¾—ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“è¿æ¥. æ¯ä¸ªæ•°æ®åº“è¿æ¥éƒ½æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ @@tx_isolation, è¡¨ç¤ºå½“å‰çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p></li><li><p>æŸ¥çœ‹å½“å‰çš„éš”ç¦»çº§åˆ«:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@tx_isolation;</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®å½“å‰ mySQL è¿æ¥çš„éš”ç¦»çº§åˆ«:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set  transaction isolation level read committed;</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®æ•°æ®åº“ç³»ç»Ÿçš„å…¨å±€çš„éš”ç¦»çº§åˆ«:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set global transaction isolation level read committed;</span><br></pre></td></tr></table></figure></li><li><p>è¡¥å……æ“ä½œï¼š</p><ul><li><p>åˆ›å»ºmysqlæ•°æ®åº“ç”¨æˆ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create user tom identified by &#x27;abc123&#x27;;</span><br></pre></td></tr></table></figure></li><li><p>æˆäºˆæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#æˆäºˆé€šè¿‡ç½‘ç»œæ–¹å¼ç™»å½•çš„tomç”¨æˆ·ï¼Œå¯¹æ‰€æœ‰åº“æ‰€æœ‰è¡¨çš„å…¨éƒ¨æƒé™ï¼Œå¯†ç è®¾ä¸ºabc123.</span><br><span class="line">grant all privileges on *.* to tom@&#x27;%&#x27;  identified by &#x27;abc123&#x27;; </span><br><span class="line"></span><br><span class="line"> #ç»™tomç”¨æˆ·ä½¿ç”¨æœ¬åœ°å‘½ä»¤è¡Œæ–¹å¼ï¼Œæˆäºˆatguigudbè¿™ä¸ªåº“ä¸‹çš„æ‰€æœ‰è¡¨çš„æ’åˆ æ”¹æŸ¥çš„æƒé™ã€‚</span><br><span class="line">grant select,insert,delete,update on atguigudb.* to tom@localhost identified by &#x27;abc123&#x27;; </span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li></ul><h2 id="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"><a href="#ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»" class="headerlink" title="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"></a>ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</h2><ul><li>DAOï¼šData Access Objectè®¿é—®æ•°æ®ä¿¡æ¯çš„ç±»å’Œæ¥å£ï¼ŒåŒ…æ‹¬äº†å¯¹æ•°æ®çš„CRUDï¼ˆCreateã€Retrivalã€Updateã€Deleteï¼‰ï¼Œè€Œä¸åŒ…å«ä»»ä½•ä¸šåŠ¡ç›¸å…³çš„ä¿¡æ¯ã€‚æœ‰æ—¶ä¹Ÿç§°ä½œï¼šBaseDAO</li><li>ä½œç”¨ï¼šä¸ºäº†å®ç°åŠŸèƒ½çš„æ¨¡å—åŒ–ï¼Œæ›´æœ‰åˆ©äºä»£ç çš„ç»´æŠ¤å’Œå‡çº§ã€‚</li><li>ä¸‹é¢æ˜¯å°šç¡…è°·JavaWebé˜¶æ®µä¹¦åŸé¡¹ç›®ä¸­DAOä½¿ç”¨çš„ä½“ç°ï¼š</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566726681515.png"></p><ul><li>å±‚æ¬¡ç»“æ„ï¼š</li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1566745811244.png"></p><h3 id="ã€BaseDAO-javaã€‘"><a href="#ã€BaseDAO-javaã€‘" class="headerlink" title="ã€BaseDAO.javaã€‘"></a>ã€BaseDAO.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.ParameterizedType;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Type;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ScalarHandler;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ä¸€ä¸ªç”¨æ¥è¢«ç»§æ‰¿çš„å¯¹æ•°æ®åº“è¿›è¡ŒåŸºæœ¬æ“ä½œçš„Dao</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> HanYanBing</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶æ³›å‹çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">private</span> Class&lt;T&gt; type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–Tçš„Classå¯¹è±¡ï¼Œè·å–æ³›å‹çš„ç±»å‹ï¼Œæ³›å‹æ˜¯åœ¨è¢«å­ç±»ç»§æ‰¿æ—¶æ‰ç¡®å®š</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseDao</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–å­ç±»çš„ç±»å‹</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass();</span><br><span class="line">        <span class="comment">// è·å–çˆ¶ç±»çš„ç±»å‹</span></span><br><span class="line">        <span class="comment">// getGenericSuperclass()ç”¨æ¥è·å–å½“å‰ç±»çš„çˆ¶ç±»çš„ç±»å‹</span></span><br><span class="line">        <span class="comment">// ParameterizedTypeè¡¨ç¤ºçš„æ˜¯å¸¦æ³›å‹çš„ç±»å‹</span></span><br><span class="line">        <span class="type">ParameterizedType</span> <span class="variable">parameterizedType</span> <span class="operator">=</span> (ParameterizedType) clazz.getGenericSuperclass();</span><br><span class="line">        <span class="comment">// è·å–å…·ä½“çš„æ³›å‹ç±»å‹ getActualTypeArgumentsè·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªTypeçš„æ•°ç»„</span></span><br><span class="line">        Type[] types = parameterizedType.getActualTypeArguments();</span><br><span class="line">        <span class="comment">// è·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹Â·</span></span><br><span class="line">        <span class="built_in">this</span>.type = (Class&lt;T&gt;) types[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šç”¨çš„å¢åˆ æ”¹æ“ä½œ</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Connection conn,String sql, Object... params)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            count = queryRunner.update(conn, sql, params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getBean</span><span class="params">(Connection conn,String sql, Object... params)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t = queryRunner.query(conn, sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;T&gt;(type), params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ‰€æœ‰å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;T&gt; <span class="title function_">getBeanList</span><span class="params">(Connection conn,String sql, Object... params)</span> &#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            list = queryRunner.query(conn, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;T&gt;(type), params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸€ä¸ªä½†ä¸€å€¼å¾—æ–¹æ³•ï¼Œä¸“é—¨ç”¨æ¥æ‰§è¡Œåƒ select count(*)...è¿™æ ·çš„sqlè¯­å¥</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">(Connection conn,String sql, Object... params)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">count</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨queryRunnerçš„queryæ–¹æ³•è·å–ä¸€ä¸ªå•ä¸€çš„å€¼</span></span><br><span class="line">            count = queryRunner.query(conn, sql, <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;&gt;(), params);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€BookDAO-javaã€‘"><a href="#ã€BookDAO-javaã€‘" class="headerlink" title="ã€BookDAO.javaã€‘"></a>ã€BookDAO.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.Book;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.Page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ‰€æœ‰çš„è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Book&gt; <span class="title function_">getBooks</span><span class="params">(Connection conn)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> book</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveBook</span><span class="params">(Connection conn,Book book)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»æ•°æ®åº“ä¸­æ ¹æ®å›¾ä¹¦çš„idåˆ é™¤ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteBookById</span><span class="params">(Connection conn,String bookId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Book <span class="title function_">getBookById</span><span class="params">(Connection conn,String bookId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æ›´æ–°ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> book</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateBook</span><span class="params">(Connection conn,Book book)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å¸¦åˆ†é¡µçš„å›¾ä¹¦ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Page&lt;Book&gt; <span class="title function_">getPageBooks</span><span class="params">(Connection conn,Page&lt;Book&gt; page)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å¸¦åˆ†é¡µå’Œä»·æ ¼èŒƒå›´çš„å›¾ä¹¦ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Page&lt;Book&gt; <span class="title function_">getPageBooksByPrice</span><span class="params">(Connection conn,Page&lt;Book&gt; page, <span class="type">double</span> minPrice, <span class="type">double</span> maxPrice)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€UserDAO-javaã€‘"><a href="#ã€UserDAO-javaã€‘" class="headerlink" title="ã€UserDAO.javaã€‘"></a>ã€UserDAO.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> User æ•°æ®åº“ä¸­æœ‰è®°å½• null æ•°æ®åº“ä¸­æ— æ­¤è®°å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    User <span class="title function_">getUser</span><span class="params">(Connection conn,User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true æ•°æ®åº“ä¸­æœ‰è®°å½• false æ•°æ®åº“ä¸­æ— æ­¤è®°å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">checkUsername</span><span class="params">(Connection conn,User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘æ•°æ®åº“ä¸­æ’å…¥Userå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(Connection conn,User user)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€BookDaoImpl-javaã€‘"><a href="#ã€BookDaoImpl-javaã€‘" class="headerlink" title="ã€BookDaoImpl.javaã€‘"></a>ã€BookDaoImpl.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.Book;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.Page;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.dao.BookDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span>&lt;Book&gt; <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">getBooks</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­å¾—åˆ°ä¸€ä¸ªListçš„æ–¹æ³•</span></span><br><span class="line">        List&lt;Book&gt; beanList = <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,title,author,price,sales,stock,img_path imgPath from books&quot;</span>;</span><br><span class="line">        beanList = getBeanList(conn,sql);</span><br><span class="line">        <span class="keyword">return</span> beanList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveBook</span><span class="params">(Connection conn,Book book)</span> &#123;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into books(title,author,price,sales,stock,img_path) values(?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span></span><br><span class="line">        update(conn,sql, book.getTitle(), book.getAuthor(), book.getPrice(), book.getSales(), book.getStock(),book.getImgPath());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBookById</span><span class="params">(Connection conn,String bookId)</span> &#123;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;DELETE FROM books WHERE id = ?&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­é€šç”¨å¢åˆ æ”¹çš„æ–¹æ³•</span></span><br><span class="line">        update(conn,sql, bookId);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">getBookById</span><span class="params">(Connection conn,String bookId)</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,title,author,price,sales,stock,img_path imgPath from books where id = ?&quot;</span>;</span><br><span class="line">        book = getBean(conn,sql, bookId);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateBook</span><span class="params">(Connection conn,Book book)</span> &#123;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update books set title = ? , author = ? , price = ? , sales = ? , stock = ? where id = ?&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span></span><br><span class="line">        update(conn,sql, book.getTitle(), book.getAuthor(), book.getPrice(), book.getSales(), book.getStock(), book.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Page&lt;Book&gt; <span class="title function_">getPageBooks</span><span class="params">(Connection conn,Page&lt;Book&gt; page)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(*) from books&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">totalRecord</span> <span class="operator">=</span> (<span class="type">long</span>) getValue(conn,sql);</span><br><span class="line">        <span class="comment">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span></span><br><span class="line">        page.setTotalRecord((<span class="type">int</span>) totalRecord);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;select id,title,author,price,sales,stock,img_path imgPath from books limit ?,?&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span></span><br><span class="line">        List&lt;Book&gt; beanList = getBeanList(conn,sql2, (page.getPageNo() - <span class="number">1</span>) * Page.PAGE_SIZE, Page.PAGE_SIZE);</span><br><span class="line">        <span class="comment">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span></span><br><span class="line">        page.setList(beanList);</span><br><span class="line">        <span class="keyword">return</span> page;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Page&lt;Book&gt; <span class="title function_">getPageBooksByPrice</span><span class="params">(Connection conn,Page&lt;Book&gt; page, <span class="type">double</span> minPrice, <span class="type">double</span> maxPrice)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(*) from books where price between ? and ?&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">totalRecord</span> <span class="operator">=</span> (<span class="type">long</span>) getValue(conn,sql,minPrice,maxPrice);</span><br><span class="line">        <span class="comment">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span></span><br><span class="line">        page.setTotalRecord((<span class="type">int</span>) totalRecord);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;select id,title,author,price,sales,stock,img_path imgPath from books where price between ? and ? limit ?,?&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span></span><br><span class="line">        List&lt;Book&gt; beanList = getBeanList(conn,sql2, minPrice , maxPrice , (page.getPageNo() - <span class="number">1</span>) * Page.PAGE_SIZE, Page.PAGE_SIZE);</span><br><span class="line">        <span class="comment">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span></span><br><span class="line">        page.setList(beanList);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> page;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€UserDaoImpl-javaã€‘"><a href="#ã€UserDaoImpl-javaã€‘" class="headerlink" title="ã€UserDaoImpl.javaã€‘"></a>ã€UserDaoImpl.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.beans.User;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.dao.BaseDao;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bookstore.dao.UserDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span>&lt;User&gt; <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(Connection conn,User user)</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">bean</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,username,password,email from users where username = ? and password = ?&quot;</span>;</span><br><span class="line">        bean = getBean(conn,sql, user.getUsername(), user.getPassword());</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkUsername</span><span class="params">(Connection conn,User user)</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">bean</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,username,password,email from users where username = ?&quot;</span>;</span><br><span class="line">        bean = getBean(conn,sql, user.getUsername());</span><br><span class="line">        <span class="keyword">return</span> bean != <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(Connection conn,User user)</span> &#123;</span><br><span class="line">        <span class="comment">//å†™sqlè¯­å¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into users(username,password,email) values(?,?,?)&quot;</span>;</span><br><span class="line">        <span class="comment">//è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span></span><br><span class="line">        update(conn,sql, user.getUsername(),user.getPassword(),user.getEmail());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€Book-javaã€‘"><a href="#ã€Book-javaã€‘" class="headerlink" title="ã€Book.javaã€‘"></a>ã€Book.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.beans;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å›¾ä¹¦ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> songhongkang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String title; <span class="comment">// ä¹¦å</span></span><br><span class="line">    <span class="keyword">private</span> String author; <span class="comment">// ä½œè€…</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> price; <span class="comment">// ä»·æ ¼</span></span><br><span class="line">    <span class="keyword">private</span> Integer sales; <span class="comment">// é”€é‡</span></span><br><span class="line">    <span class="keyword">private</span> Integer stock; <span class="comment">// åº“å­˜</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">imgPath</span> <span class="operator">=</span> <span class="string">&quot;static/img/default.jpg&quot;</span>; <span class="comment">// å°é¢å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line">    <span class="comment">//æ„é€ å™¨ï¼Œget()ï¼Œset()ï¼ŒtoString()æ–¹æ³•ç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ã€Page-javaã€‘"><a href="#ã€Page-javaã€‘" class="headerlink" title="ã€Page.javaã€‘"></a>ã€Page.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¡µç ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> songhongkang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Page</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; list; <span class="comment">// æ¯é¡µæŸ¥åˆ°çš„è®°å½•å­˜æ”¾çš„é›†åˆ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PAGE_SIZE</span> <span class="operator">=</span> <span class="number">4</span>; <span class="comment">// æ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> pageNo; <span class="comment">// å½“å‰é¡µ</span></span><br><span class="line"><span class="comment">//    private int totalPageNo; // æ€»é¡µæ•°ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> totalRecord; <span class="comment">// æ€»è®°å½•æ•°ï¼Œé€šè¿‡æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ã€User-javaã€‘"><a href="#ã€User-javaã€‘" class="headerlink" title="ã€User.javaã€‘"></a>ã€User.javaã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bookstore.beans;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> songhongkang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "><a href="#ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "></a>ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </h2><h3 id="8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"><a href="#8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§" class="headerlink" title="8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"></a>8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</h3><ul><li><p>åœ¨ä½¿ç”¨å¼€å‘åŸºäºæ•°æ®åº“çš„webç¨‹åºæ—¶ï¼Œä¼ ç»Ÿçš„æ¨¡å¼åŸºæœ¬æ˜¯æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼šã€€ã€€</p><ul><li><strong>åœ¨ä¸»ç¨‹åºï¼ˆå¦‚servletã€beansï¼‰ä¸­å»ºç«‹æ•°æ®åº“è¿æ¥</strong></li><li><strong>è¿›è¡Œsqlæ“ä½œ</strong></li><li><strong>æ–­å¼€æ•°æ®åº“è¿æ¥</strong></li></ul></li><li><p>è¿™ç§æ¨¡å¼å¼€å‘ï¼Œå­˜åœ¨çš„é—®é¢˜:</p><ul><li>æ™®é€šçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManager æ¥è·å–ï¼Œæ¯æ¬¡å‘æ•°æ®åº“å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½è¦å°† Connection åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†éªŒè¯ç”¨æˆ·åå’Œå¯†ç (å¾—èŠ±è´¹0.05sï½1sçš„æ—¶é—´)ã€‚éœ€è¦æ•°æ®åº“è¿æ¥çš„æ—¶å€™ï¼Œå°±å‘æ•°æ®åº“è¦æ±‚ä¸€ä¸ªï¼Œæ‰§è¡Œå®Œæˆåå†æ–­å¼€è¿æ¥ã€‚è¿™æ ·çš„æ–¹å¼å°†ä¼šæ¶ˆè€—å¤§é‡çš„èµ„æºå’Œæ—¶é—´ã€‚<strong>æ•°æ®åº“çš„è¿æ¥èµ„æºå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„é‡å¤åˆ©ç”¨ã€‚</strong>è‹¥åŒæ—¶æœ‰å‡ ç™¾äººç”šè‡³å‡ åƒäººåœ¨çº¿ï¼Œé¢‘ç¹çš„è¿›è¡Œæ•°æ®åº“è¿æ¥æ“ä½œå°†å ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æºï¼Œä¸¥é‡çš„ç”šè‡³ä¼šé€ æˆæœåŠ¡å™¨çš„å´©æºƒã€‚</li><li><strong>å¯¹äºæ¯ä¸€æ¬¡æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨å®Œåéƒ½å¾—æ–­å¼€ã€‚</strong>å¦åˆ™ï¼Œå¦‚æœç¨‹åºå‡ºç°å¼‚å¸¸è€Œæœªèƒ½å…³é—­ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®åº“ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆå°†å¯¼è‡´é‡å¯æ•°æ®åº“ã€‚ï¼ˆå›å¿†ï¼šä½•ä¸ºJavaçš„å†…å­˜æ³„æ¼ï¼Ÿï¼‰</li><li><strong>è¿™ç§å¼€å‘ä¸èƒ½æ§åˆ¶è¢«åˆ›å»ºçš„è¿æ¥å¯¹è±¡æ•°</strong>ï¼Œç³»ç»Ÿèµ„æºä¼šè¢«æ¯«æ— é¡¾åŠçš„åˆ†é…å‡ºå»ï¼Œå¦‚è¿æ¥è¿‡å¤šï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ŒæœåŠ¡å™¨å´©æºƒã€‚</li></ul></li></ul><h3 id="8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"><a href="#8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯" class="headerlink" title="8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"></a>8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</h3><ul><li><p>ä¸ºè§£å†³ä¼ ç»Ÿå¼€å‘ä¸­çš„æ•°æ®åº“è¿æ¥é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯ã€‚</p></li><li><p><strong>æ•°æ®åº“è¿æ¥æ± çš„åŸºæœ¬æ€æƒ³</strong>ï¼šå°±æ˜¯ä¸ºæ•°æ®åº“è¿æ¥å»ºç«‹ä¸€ä¸ªâ€œç¼“å†²æ± â€ã€‚é¢„å…ˆåœ¨ç¼“å†²æ± ä¸­æ”¾å…¥ä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œå½“éœ€è¦å»ºç«‹æ•°æ®åº“è¿æ¥æ—¶ï¼Œåªéœ€ä»â€œç¼“å†²æ± â€ä¸­å–å‡ºä¸€ä¸ªï¼Œä½¿ç”¨å®Œæ¯•ä¹‹åå†æ”¾å›å»ã€‚</p></li><li><p><strong>æ•°æ®åº“è¿æ¥æ± </strong>è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œå®ƒ<strong>å…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯é‡æ–°å»ºç«‹ä¸€ä¸ª</strong>ã€‚</p></li><li><p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–æ—¶å°†åˆ›å»ºä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥æ”¾åˆ°è¿æ¥æ± ä¸­ï¼Œè¿™äº›æ•°æ®åº“è¿æ¥çš„æ•°é‡æ˜¯ç”±<strong>æœ€å°æ•°æ®åº“è¿æ¥æ•°æ¥è®¾å®š</strong>çš„ã€‚æ— è®ºè¿™äº›æ•°æ®åº“è¿æ¥æ˜¯å¦è¢«ä½¿ç”¨ï¼Œè¿æ¥æ± éƒ½å°†ä¸€ç›´ä¿è¯è‡³å°‘æ‹¥æœ‰è¿™ä¹ˆå¤šçš„è¿æ¥æ•°é‡ã€‚è¿æ¥æ± çš„<strong>æœ€å¤§æ•°æ®åº“è¿æ¥æ•°é‡</strong>é™å®šäº†è¿™ä¸ªè¿æ¥æ± èƒ½å æœ‰çš„æœ€å¤§è¿æ¥æ•°ï¼Œå½“åº”ç”¨ç¨‹åºå‘è¿æ¥æ± è¯·æ±‚çš„è¿æ¥æ•°è¶…è¿‡æœ€å¤§è¿æ¥æ•°é‡æ—¶ï¼Œè¿™äº›è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B1555593464033.png"></p><ul><li><strong>å·¥ä½œåŸç†ï¼š</strong></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555593598606.png"></p><ul><li><strong>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯çš„ä¼˜ç‚¹</strong><br><strong>1. èµ„æºé‡ç”¨</strong><br>ç”±äºæ•°æ®åº“è¿æ¥å¾—ä»¥é‡ç”¨ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºï¼Œé‡Šæ”¾è¿æ¥å¼•èµ·çš„å¤§é‡æ€§èƒ½å¼€é”€ã€‚åœ¨å‡å°‘ç³»ç»Ÿæ¶ˆè€—çš„åŸºç¡€ä¸Šï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¢åŠ äº†ç³»ç»Ÿè¿è¡Œç¯å¢ƒçš„å¹³ç¨³æ€§ã€‚<br><strong>2. æ›´å¿«çš„ç³»ç»Ÿååº”é€Ÿåº¦</strong><br>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å·²ç»åˆ›å»ºäº†è‹¥å¹²æ•°æ®åº“è¿æ¥ç½®äºè¿æ¥æ± ä¸­å¤‡ç”¨ã€‚æ­¤æ—¶è¿æ¥çš„åˆå§‹åŒ–å·¥ä½œå‡å·²å®Œæˆã€‚å¯¹äºä¸šåŠ¡è¯·æ±‚å¤„ç†è€Œè¨€ï¼Œç›´æ¥åˆ©ç”¨ç°æœ‰å¯ç”¨è¿æ¥ï¼Œé¿å…äº†æ•°æ®åº“è¿æ¥åˆå§‹åŒ–å’Œé‡Šæ”¾è¿‡ç¨‹çš„æ—¶é—´å¼€é”€ï¼Œä»è€Œå‡å°‘äº†ç³»ç»Ÿçš„å“åº”æ—¶é—´<br><strong>3. æ–°çš„èµ„æºåˆ†é…æ‰‹æ®µ</strong><br>å¯¹äºå¤šåº”ç”¨å…±äº«åŒä¸€æ•°æ®åº“çš„ç³»ç»Ÿè€Œè¨€ï¼Œå¯åœ¨åº”ç”¨å±‚é€šè¿‡æ•°æ®åº“è¿æ¥æ± çš„é…ç½®ï¼Œå®ç°æŸä¸€åº”ç”¨æœ€å¤§å¯ç”¨æ•°æ®åº“è¿æ¥æ•°çš„é™åˆ¶ï¼Œé¿å…æŸä¸€åº”ç”¨ç‹¬å æ‰€æœ‰çš„æ•°æ®åº“èµ„æº<br><strong>4. ç»Ÿä¸€çš„è¿æ¥ç®¡ç†ï¼Œé¿å…æ•°æ®åº“è¿æ¥æ³„æ¼</strong><br>åœ¨è¾ƒä¸ºå®Œå–„çš„æ•°æ®åº“è¿æ¥æ± å®ç°ä¸­ï¼Œå¯æ ¹æ®é¢„å…ˆçš„å ç”¨è¶…æ—¶è®¾å®šï¼Œå¼ºåˆ¶å›æ”¶è¢«å ç”¨è¿æ¥ï¼Œä»è€Œé¿å…äº†å¸¸è§„æ•°æ®åº“è¿æ¥æ“ä½œä¸­å¯èƒ½å‡ºç°çš„èµ„æºæ³„éœ²</li></ul><h3 id="8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "></a>8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </h3><ul><li>JDBC çš„æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ javax.sql.DataSource æ¥è¡¨ç¤ºï¼ŒDataSource åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é€šå¸¸ç”±æœåŠ¡å™¨(Weblogic, WebSphere, Tomcat)æä¾›å®ç°ï¼Œä¹Ÿæœ‰ä¸€äº›å¼€æºç»„ç»‡æä¾›å®ç°ï¼š<ul><li><strong>DBCP</strong> æ˜¯Apacheæä¾›çš„æ•°æ®åº“è¿æ¥æ± ã€‚tomcat æœåŠ¡å™¨è‡ªå¸¦dbcpæ•°æ®åº“è¿æ¥æ± ã€‚<strong>é€Ÿåº¦ç›¸å¯¹c3p0è¾ƒå¿«</strong>ï¼Œä½†å› è‡ªèº«å­˜åœ¨BUGï¼ŒHibernate3å·²ä¸å†æä¾›æ”¯æŒã€‚</li><li><strong>C3P0</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œ<strong>é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç¨³å®šæ€§è¿˜å¯ä»¥ã€‚</strong>hibernateå®˜æ–¹æ¨èä½¿ç”¨</li><li><strong>Proxool</strong> æ˜¯sourceforgeä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ•°æ®åº“è¿æ¥æ± ï¼Œæœ‰ç›‘æ§è¿æ¥æ± çŠ¶æ€çš„åŠŸèƒ½ï¼Œ<strong>ç¨³å®šæ€§è¾ƒc3p0å·®ä¸€ç‚¹</strong></li><li><strong>BoneCP</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦å¿«</li><li><strong>Druid</strong> æ˜¯é˜¿é‡Œæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ®è¯´æ˜¯é›†DBCP ã€C3P0 ã€Proxool ä¼˜ç‚¹äºä¸€èº«çš„æ•°æ®åº“è¿æ¥æ± ï¼Œä½†æ˜¯é€Ÿåº¦ä¸ç¡®å®šæ˜¯å¦æœ‰BoneCPå¿«</li></ul></li><li>DataSource é€šå¸¸è¢«ç§°ä¸ºæ•°æ®æºï¼Œå®ƒåŒ…å«è¿æ¥æ± å’Œè¿æ¥æ± ç®¡ç†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¹ æƒ¯ä¸Šä¹Ÿç»å¸¸æŠŠ DataSource ç§°ä¸ºè¿æ¥æ± </li><li><strong>DataSourceç”¨æ¥å–ä»£DriverManageræ¥è·å–Connectionï¼Œè·å–é€Ÿåº¦å¿«ï¼ŒåŒæ—¶å¯ä»¥å¤§å¹…åº¦æé«˜æ•°æ®åº“è®¿é—®é€Ÿåº¦ã€‚</strong></li><li>ç‰¹åˆ«æ³¨æ„ï¼š<ul><li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤<strong>æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</strong></li><li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†conn.close()å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li></ul></li></ul><h4 id="8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± "></a>8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </h4><ul><li>è·å–è¿æ¥æ–¹å¼ä¸€</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šä¸æ¨è</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br><span class="line">    cpds.setDriverClass(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>); </span><br><span class="line">    cpds.setJdbcUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>);</span><br><span class="line">    cpds.setUser(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    cpds.setPassword(<span class="string">&quot;abc123&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//    cpds.setMaxPoolSize(100);</span></span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è·å–è¿æ¥æ–¹å¼äºŒ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;helloc3p0&quot;</span>);</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection2</span><span class="params">()</span> <span class="keyword">throws</span> SQLException&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€c3p0-config.xmlã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;helloc3p0&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è·å–è¿æ¥çš„4ä¸ªåŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>abc123<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql:///test<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ¶‰åŠåˆ°æ•°æ®åº“è¿æ¥æ± çš„ç®¡ç†çš„ç›¸å…³å±æ€§çš„è®¾ç½® --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è‹¥æ•°æ®åº“ä¸­è¿æ¥æ•°ä¸è¶³æ—¶, ä¸€æ¬¡å‘æ•°æ®åº“æœåŠ¡å™¨ç”³è¯·å¤šå°‘ä¸ªè¿æ¥ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± æ—¶è¿æ¥çš„æ•°é‡ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å°çš„æ•°æ®åº“è¿æ¥æ•° --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å¤§çš„æ•°æ®åº“è¿æ¥æ•° --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- C3P0 æ•°æ®åº“è¿æ¥æ± å¯ä»¥ç»´æŠ¤çš„ Statement çš„ä¸ªæ•° --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatements&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ¯ä¸ªè¿æ¥åŒæ—¶å¯ä»¥ä½¿ç”¨çš„ Statement å¯¹è±¡çš„ä¸ªæ•° --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatementsPerConnection&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± "><a href="#8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± "></a>8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </h4><ul><li>DBCP æ˜¯ Apache è½¯ä»¶åŸºé‡‘ç»„ç»‡ä¸‹çš„å¼€æºè¿æ¥æ± å®ç°ï¼Œè¯¥è¿æ¥æ± ä¾èµ–è¯¥ç»„ç»‡ä¸‹çš„å¦ä¸€ä¸ªå¼€æºç³»ç»Ÿï¼šCommon-poolã€‚å¦‚éœ€ä½¿ç”¨è¯¥è¿æ¥æ± å®ç°ï¼Œåº”åœ¨ç³»ç»Ÿä¸­å¢åŠ å¦‚ä¸‹ä¸¤ä¸ª jar æ–‡ä»¶ï¼š<ul><li>Commons-dbcp.jarï¼šè¿æ¥æ± çš„å®ç°</li><li>Commons-pool.jarï¼šè¿æ¥æ± å®ç°çš„ä¾èµ–åº“</li></ul></li><li><strong>Tomcat çš„è¿æ¥æ± æ­£æ˜¯é‡‡ç”¨è¯¥è¿æ¥æ± æ¥å®ç°çš„ã€‚</strong>è¯¥æ•°æ®åº“è¿æ¥æ± æ—¢å¯ä»¥ä¸åº”ç”¨æœåŠ¡å™¨æ•´åˆä½¿ç”¨ï¼Œä¹Ÿå¯ç”±åº”ç”¨ç¨‹åºç‹¬ç«‹ä½¿ç”¨ã€‚</li><li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</li><li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†ä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li><li>é…ç½®å±æ€§è¯´æ˜</li></ul><table><thead><tr><th>å±æ€§</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>initialSize</td><td>0</td><td>è¿æ¥æ± å¯åŠ¨æ—¶åˆ›å»ºçš„åˆå§‹åŒ–è¿æ¥æ•°é‡</td></tr><tr><td>maxActive</td><td>8</td><td>è¿æ¥æ± ä¸­å¯åŒæ—¶è¿æ¥çš„æœ€å¤§çš„è¿æ¥æ•°</td></tr><tr><td>maxIdle</td><td>8</td><td>è¿æ¥æ± ä¸­æœ€å¤§çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œè¶…è¿‡çš„ç©ºé—²è¿æ¥å°†è¢«é‡Šæ”¾ï¼Œå¦‚æœè®¾ç½®ä¸ºè´Ÿæ•°è¡¨ç¤ºä¸é™åˆ¶</td></tr><tr><td>minIdle</td><td>0</td><td>è¿æ¥æ± ä¸­æœ€å°çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œä½äºè¿™ä¸ªæ•°é‡ä¼šè¢«åˆ›å»ºæ–°çš„è¿æ¥ã€‚è¯¥å‚æ•°è¶Šæ¥è¿‘maxIdleï¼Œæ€§èƒ½è¶Šå¥½ï¼Œå› ä¸ºè¿æ¥çš„åˆ›å»ºå’Œé”€æ¯ï¼Œéƒ½æ˜¯éœ€è¦æ¶ˆè€—èµ„æºçš„ï¼›ä½†æ˜¯ä¸èƒ½å¤ªå¤§ã€‚</td></tr><tr><td>maxWait</td><td>æ— é™åˆ¶</td><td>æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå½“æ²¡æœ‰å¯ç”¨è¿æ¥æ—¶ï¼Œè¿æ¥æ± ç­‰å¾…è¿æ¥é‡Šæ”¾çš„æœ€å¤§æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´é™åˆ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœè®¾ç½®-1è¡¨ç¤ºæ— é™ç­‰å¾…</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>å¼€å¯æ± çš„Statementæ˜¯å¦prepared</td></tr><tr><td>maxOpenPreparedStatements</td><td>æ— é™åˆ¶</td><td>å¼€å¯æ± çš„prepared åçš„åŒæ—¶æœ€å¤§è¿æ¥æ•°</td></tr><tr><td>minEvictableIdleTimeMillis</td><td></td><td>è¿æ¥æ± ä¸­è¿æ¥ï¼Œåœ¨æ—¶é—´æ®µå†…ä¸€ç›´ç©ºé—²ï¼Œ è¢«é€å‡ºè¿æ¥æ± çš„æ—¶é—´</td></tr><tr><td>removeAbandonedTimeout</td><td>300</td><td>è¶…è¿‡æ—¶é—´é™åˆ¶ï¼Œå›æ”¶æ²¡æœ‰ç”¨(åºŸå¼ƒ)çš„è¿æ¥</td></tr><tr><td>removeAbandoned</td><td>false</td><td>è¶…è¿‡removeAbandonedTimeoutæ—¶é—´åï¼Œæ˜¯å¦è¿› è¡Œæ²¡ç”¨è¿æ¥ï¼ˆåºŸå¼ƒï¼‰çš„å›æ”¶</td></tr></tbody></table><ul><li>è·å–è¿æ¥æ–¹å¼ä¸€ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection3</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">BasicDataSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSource</span>();</span><br><span class="line"></span><br><span class="line">    source.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">    source.setUrl(<span class="string">&quot;jdbc:mysql:///test&quot;</span>);</span><br><span class="line">    source.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    source.setPassword(<span class="string">&quot;abc123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    source.setInitialSize(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è·å–è¿æ¥æ–¹å¼äºŒï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨dbcpæ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">static</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">pros</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> DBCPTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;dbcp.properties&quot;</span>);</span><br><span class="line"></span><br><span class="line">        pros.load(is);</span><br><span class="line">        <span class="comment">//æ ¹æ®æä¾›çš„BasicDataSourceFactoryåˆ›å»ºå¯¹åº”çš„DataSourceå¯¹è±¡</span></span><br><span class="line">        source = BasicDataSourceFactory.createDataSource(pros);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection4</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> source.getConnection();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> conn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€dbcp.propertiesã€‘</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true&amp;useServerPrepStmts=false</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">abc123</span></span><br><span class="line"></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">#...</span></span><br></pre></td></tr></table></figure><h4 id="8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "></a>8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </h4><p>Druidæ˜¯é˜¿é‡Œå·´å·´å¼€æºå¹³å°ä¸Šä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œå®ƒç»“åˆäº†C3P0ã€DBCPã€Proxoolç­‰DBæ± çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åŠ å…¥äº†æ—¥å¿—ç›‘æ§ï¼Œå¯ä»¥å¾ˆå¥½çš„ç›‘æ§DBæ± è¿æ¥å’ŒSQLçš„æ‰§è¡Œæƒ…å†µï¼Œå¯ä»¥è¯´æ˜¯é’ˆå¯¹ç›‘æ§è€Œç”Ÿçš„DBè¿æ¥æ± ï¼Œ<strong>å¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¥½çš„è¿æ¥æ± ä¹‹ä¸€ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.druid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDruid</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();         pro.load(TestDruid.class.getClassLoader().getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>));</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ds.getConnection();</span><br><span class="line">        System.out.println(conn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€druid.propertiesã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/test?rewriteBatchedStatements=true</span></span><br><span class="line">username=root</span><br><span class="line">password=<span class="number">123456</span></span><br><span class="line">driverClassName=com.mysql.jdbc.Driver</span><br><span class="line"></span><br><span class="line">initialSize=<span class="number">10</span></span><br><span class="line">maxActive=<span class="number">20</span></span><br><span class="line">maxWait=<span class="number">1000</span></span><br><span class="line">filters=wall</span><br></pre></td></tr></table></figure><ul><li>è¯¦ç»†é…ç½®å‚æ•°ï¼š</li></ul><table><thead><tr><th><strong>é…ç½®</strong></th><th><strong>ç¼ºçœ</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>name</td><td></td><td>é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚ å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œæ ¼å¼æ˜¯ï¼šâ€DataSource-â€ + System.identityHashCode(this)</td></tr><tr><td>url</td><td></td><td>è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql : jdbc:mysql:&#x2F;&#x2F;10.20.153.104:3306&#x2F;druid2 oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td></tr><tr><td>username</td><td></td><td>è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å</td></tr><tr><td>password</td><td></td><td>è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œï¼š<a class="link" target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter<i class="fas fa-external-link-alt"></i></a></td></tr><tr><td>driverClassName</td><td></td><td>æ ¹æ®urlè‡ªåŠ¨è¯†åˆ« è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName(å»ºè®®é…ç½®ä¸‹)</td></tr><tr><td>initialSize</td><td>0</td><td>åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶</td></tr><tr><td>maxActive</td><td>8</td><td>æœ€å¤§è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxIdle</td><td>8</td><td>å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</td></tr><tr><td>minIdle</td><td></td><td>æœ€å°è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxWait</td><td></td><td>è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysqlä¸‹å»ºè®®å…³é—­ã€‚</td></tr><tr><td>maxOpenPreparedStatements</td><td>-1</td><td>è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100</td></tr><tr><td>validationQuery</td><td></td><td>ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚</td></tr><tr><td>testOnBorrow</td><td>true</td><td>ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚</td></tr><tr><td>testOnReturn</td><td>false</td><td>å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</td></tr><tr><td>testWhileIdle</td><td>false</td><td>å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</td></tr><tr><td>timeBetweenEvictionRunsMillis</td><td></td><td>æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1)Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´2)testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜</td></tr><tr><td>numTestsPerEvictionRun</td><td></td><td>ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun</td></tr><tr><td>minEvictableIdleTimeMillis</td><td></td><td></td></tr><tr><td>connectionInitSqls</td><td></td><td>ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql</td></tr><tr><td>exceptionSorter</td><td></td><td>æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ« å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥</td></tr><tr><td>filters</td><td></td><td>å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:statæ—¥å¿—ç”¨çš„filter:log4jé˜²å¾¡sqlæ³¨å…¥çš„filter:wall</td></tr><tr><td>proxyFilters</td><td></td><td>ç±»å‹æ˜¯Listï¼Œå¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œæ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³»</td></tr></tbody></table><h2 id="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"><a href="#ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"></a>ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</h2><h3 id="9-1-Apache-DBUtilsç®€ä»‹"><a href="#9-1-Apache-DBUtilsç®€ä»‹" class="headerlink" title="9.1 Apache-DBUtilsç®€ä»‹"></a>9.1 Apache-DBUtilsç®€ä»‹</h3><ul><li><p>commons-dbutils æ˜¯ Apache ç»„ç»‡æä¾›çš„ä¸€ä¸ªå¼€æº JDBCå·¥å…·ç±»åº“ï¼Œå®ƒæ˜¯å¯¹JDBCçš„ç®€å•å°è£…ï¼Œå­¦ä¹ æˆæœ¬æä½ï¼Œå¹¶ä¸”ä½¿ç”¨dbutilsèƒ½æå¤§ç®€åŒ–jdbcç¼–ç çš„å·¥ä½œé‡ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p></li><li><p>APIä»‹ç»ï¼š</p><ul><li>org.apache.commons.dbutils.QueryRunner</li><li>org.apache.commons.dbutils.ResultSetHandler</li><li>å·¥å…·ç±»ï¼šorg.apache.commons.dbutils.DbUtils</li></ul></li><li><p>APIåŒ…è¯´æ˜ï¼š</p></li></ul><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555595163263.png"></p><p><img lazyload alt="image" data-src="/2021/08/25/JDBC%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/1555595198644.png"></p><h3 id="9-2-ä¸»è¦APIçš„ä½¿ç”¨"><a href="#9-2-ä¸»è¦APIçš„ä½¿ç”¨" class="headerlink" title="9.2 ä¸»è¦APIçš„ä½¿ç”¨"></a>9.2 ä¸»è¦APIçš„ä½¿ç”¨</h3><h4 id="9-2-1-DbUtils"><a href="#9-2-1-DbUtils" class="headerlink" title="9.2.1 DbUtils"></a>9.2.1 DbUtils</h4><ul><li>DbUtils ï¼šæä¾›å¦‚å…³é—­è¿æ¥ã€è£…è½½JDBCé©±åŠ¨ç¨‹åºç­‰å¸¸è§„å·¥ä½œçš„å·¥å…·ç±»ï¼Œé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š<ul><li><strong>public static void close(â€¦) throws java.sql.SQLException</strong>ï¼šã€€DbUtilsç±»æä¾›äº†ä¸‰ä¸ªé‡è½½çš„å…³é—­æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ£€æŸ¥æ‰€æä¾›çš„å‚æ•°æ˜¯ä¸æ˜¯NULLï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå®ƒä»¬å°±å…³é—­Connectionã€Statementå’ŒResultSetã€‚</li><li>public static void closeQuietly(â€¦): è¿™ä¸€ç±»æ–¹æ³•ä¸ä»…èƒ½åœ¨Connectionã€Statementå’ŒResultSetä¸ºNULLæƒ…å†µä¸‹é¿å…å…³é—­ï¼Œè¿˜èƒ½éšè—ä¸€äº›åœ¨ç¨‹åºä¸­æŠ›å‡ºçš„SQLEeceptionã€‚</li><li>public static void commitAndClose(Connection conn)throws SQLExceptionï¼š ç”¨æ¥æäº¤è¿æ¥çš„äº‹åŠ¡ï¼Œç„¶åå…³é—­è¿æ¥</li><li>public static void commitAndCloseQuietly(Connection conn)ï¼š ç”¨æ¥æäº¤è¿æ¥ï¼Œç„¶åå…³é—­è¿æ¥ï¼Œå¹¶ä¸”åœ¨å…³é—­è¿æ¥æ—¶ä¸æŠ›å‡ºSQLå¼‚å¸¸ã€‚</li><li>public static void rollback(Connection conn)throws SQLExceptionï¼šå…è®¸connä¸ºnullï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨åšäº†åˆ¤æ–­</li><li>public static void rollbackAndClose(Connection conn)throws SQLException</li><li>rollbackAndCloseQuietly(Connection)</li><li>public static boolean loadDriver(java.lang.String driverClassName)ï¼šè¿™ä¸€æ–¹è£…è½½å¹¶æ³¨å†ŒJDBCé©±åŠ¨ç¨‹åºï¼Œå¦‚æœæˆåŠŸå°±è¿”å›trueã€‚ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä½ ä¸éœ€è¦æ•æ‰è¿™ä¸ªå¼‚å¸¸ClassNotFoundExceptionã€‚</li></ul></li></ul><h4 id="9-2-2-QueryRunnerç±»"><a href="#9-2-2-QueryRunnerç±»" class="headerlink" title="9.2.2 QueryRunnerç±»"></a>9.2.2 QueryRunnerç±»</h4><ul><li><p><strong>è¯¥ç±»ç®€å•åŒ–äº†SQLæŸ¥è¯¢ï¼Œå®ƒä¸ResultSetHandlerç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„æ•°æ®åº“æ“ä½œï¼Œèƒ½å¤Ÿå¤§å¤§å‡å°‘ç¼–ç é‡ã€‚</strong></p></li><li><p>QueryRunnerç±»æä¾›äº†ä¸¤ä¸ªæ„é€ å™¨ï¼š</p><ul><li>é»˜è®¤çš„æ„é€ å™¨</li><li>éœ€è¦ä¸€ä¸ª javax.sql.DataSource æ¥ä½œå‚æ•°çš„æ„é€ å™¨</li></ul></li><li><p>QueryRunnerç±»çš„ä¸»è¦æ–¹æ³•ï¼š</p><ul><li><strong>æ›´æ–°</strong><ul><li>public int update(Connection conn, String sql, Objectâ€¦ params) throws SQLException:ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ›´æ–°ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰æ“ä½œã€‚</li><li>â€¦â€¦</li></ul></li><li><strong>æ’å…¥</strong><ul><li>public<t>T insert(Connection conn,String sql,ResultSetHandler<t>rsh, Objectâ€¦ params) throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥ï¼Œå…¶ä¸­ rsh - The handler used to create the result object from the ResultSet of auto-generated keys. è¿”å›å€¼: An object generated by the handler.å³è‡ªåŠ¨ç”Ÿæˆçš„é”®å€¼</t></t></li><li>â€¦.</li></ul></li><li><strong>æ‰¹å¤„ç†</strong><ul><li>public int[] batch(Connection conn,String sql,Object[][] params)throws SQLExceptionï¼š INSERT, UPDATE, or DELETEè¯­å¥</li><li>public<t>T insertBatch(Connection conn,String sql,ResultSetHandler<t>rsh,Object[][] params)throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥</t></t></li><li>â€¦..</li></ul></li><li><strong>æŸ¥è¯¢</strong><ul><li>public Object query(Connection conn, String sql, ResultSetHandler rsh,Objectâ€¦ params) throws SQLExceptionï¼šæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå¯¹è±¡æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼è¢«ç”¨æ¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ç½®æ¢å‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šè‡ªè¡Œå¤„ç† PreparedStatement å’Œ ResultSet çš„åˆ›å»ºå’Œå…³é—­ã€‚</li><li>â€¦â€¦</li></ul></li></ul></li><li><p>æµ‹è¯•</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æ·»åŠ </span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into customers(name,email,birth)values(?,?,?)&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> runner.update(conn, sql, <span class="string">&quot;ä½•æˆé£&quot;</span>, <span class="string">&quot;he@qq.com&quot;</span>, <span class="string">&quot;1992-09-08&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;æ·»åŠ äº†&quot;</span> + count + <span class="string">&quot;æ¡è®°å½•&quot;</span>);</span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•åˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from customers where id &lt; ?&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> runner.update(conn, sql,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;åˆ é™¤äº†&quot;</span> + count + <span class="string">&quot;æ¡è®°å½•&quot;</span>);</span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»"><a href="#9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»" class="headerlink" title="9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»"></a>9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</h4><ul><li><p>è¯¥æ¥å£ç”¨äºå¤„ç† java.sql.ResultSetï¼Œå°†æ•°æ®æŒ‰è¦æ±‚è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ã€‚</p></li><li><p>ResultSetHandler æ¥å£æä¾›äº†ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ï¼šObject handle (java.sql.ResultSet .rs)ã€‚</p></li><li><p>æ¥å£çš„ä¸»è¦å®ç°ç±»ï¼š</p><ul><li>ArrayHandlerï¼šæŠŠç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®è½¬æˆå¯¹è±¡æ•°ç»„ã€‚</li><li>ArrayListHandlerï¼šæŠŠç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½è½¬æˆä¸€ä¸ªæ•°ç»„ï¼Œå†å­˜æ”¾åˆ°Listä¸­ã€‚</li><li><strong>BeanHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ã€‚</li><li><strong>BeanListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ï¼Œå­˜æ”¾åˆ°Listé‡Œã€‚</li><li>ColumnListHandlerï¼šå°†ç»“æœé›†ä¸­æŸä¸€åˆ—çš„æ•°æ®å­˜æ”¾åˆ°Listä¸­ã€‚</li><li>KeyedHandler(name)ï¼šå°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œå†æŠŠè¿™äº›mapå†å­˜åˆ°ä¸€ä¸ªmapé‡Œï¼Œå…¶keyä¸ºæŒ‡å®šçš„keyã€‚</li><li><strong>MapHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œkeyæ˜¯åˆ—åï¼Œvalueå°±æ˜¯å¯¹åº”çš„å€¼ã€‚</li><li><strong>MapListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œç„¶åå†å­˜æ”¾åˆ°List</li><li><strong>ScalarHandlerï¼š</strong>æŸ¥è¯¢å•ä¸ªå€¼å¯¹è±¡</li></ul></li><li><p>æµ‹è¯•</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanHandler</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryInstance</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,email,birth from customers where id = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    BeanHandler&lt;Customer&gt; handler = <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;&gt;(Customer.class);</span><br><span class="line">    <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> runner.query(conn, sql, handler, <span class="number">23</span>);</span><br><span class="line">    System.out.println(customer);    </span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢å¤šæ¡è®°å½•æ„æˆçš„é›†åˆ</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanListHandler</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryList</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,email,birth from customers where id &lt; ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    BeanListHandler&lt;Customer&gt; handler = <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;&gt;(Customer.class);</span><br><span class="line">    List&lt;Customer&gt; list = runner.query(conn, sql, handler, <span class="number">23</span>);</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰ResultSetHandlerçš„å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryInstance1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,email,birth from customers where id = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    ResultSetHandler&lt;Customer&gt; handler = <span class="keyword">new</span> <span class="title class_">ResultSetHandler</span>&lt;Customer&gt;() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Customer <span class="title function_">handle</span><span class="params">(ResultSet rs)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;handle&quot;</span>);</span><br><span class="line"><span class="comment">//            return new Customer(1,&quot;Tom&quot;,&quot;tom@126.com&quot;,new Date(123323432L));</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">                <span class="type">Date</span> <span class="variable">birth</span> <span class="operator">=</span> rs.getDate(<span class="string">&quot;birth&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Customer</span>(id, name, email, birth);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">Customer</span> <span class="variable">customer</span> <span class="operator">=</span> runner.query(conn, sql, handler, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(customer);</span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * å¦‚ä½•æŸ¥è¯¢ç±»ä¼¼äºæœ€å¤§çš„ï¼Œæœ€å°çš„ï¼Œå¹³å‡çš„ï¼Œæ€»å’Œï¼Œä¸ªæ•°ç›¸å…³çš„æ•°æ®ï¼Œ</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ScalarHandler</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryValue</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="type">QueryRunner</span> <span class="variable">runner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> JDBCUtils.getConnection3();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æµ‹è¯•ä¸€ï¼š</span></span><br><span class="line"><span class="comment">//    String sql = &quot;select count(*) from customers where id &lt; ?&quot;;</span></span><br><span class="line"><span class="comment">//    ScalarHandler handler = new ScalarHandler();</span></span><br><span class="line"><span class="comment">//    long count = (long) runner.query(conn, sql, handler, 20);</span></span><br><span class="line"><span class="comment">//    System.out.println(count);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æµ‹è¯•äºŒï¼š</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select max(birth) from customers&quot;</span>;</span><br><span class="line">    <span class="type">ScalarHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>();</span><br><span class="line">    <span class="type">Date</span> <span class="variable">birth</span> <span class="operator">=</span> (Date) runner.query(conn, sql, handler);</span><br><span class="line">    System.out.println(birth);</span><br><span class="line"></span><br><span class="line">    JDBCUtils.closeResource(conn, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="JDBCæ€»ç»“"><a href="#JDBCæ€»ç»“" class="headerlink" title="JDBCæ€»ç»“"></a>JDBCæ€»ç»“</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">æ€»ç»“</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdateWithTx</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1.è·å–è¿æ¥çš„æ“ä½œï¼ˆ</span></span><br><span class="line">        <span class="comment">//â‘  æ‰‹å†™çš„è¿æ¥ï¼šJDBCUtils.getConnection();</span></span><br><span class="line">        <span class="comment">//â‘¡ ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ï¼šC3P0;DBCP;Druid</span></span><br><span class="line">        <span class="comment">//2.å¯¹æ•°æ®è¡¨è¿›è¡Œä¸€ç³»åˆ—CRUDæ“ä½œ</span></span><br><span class="line">        <span class="comment">//â‘  ä½¿ç”¨PreparedStatementå®ç°é€šç”¨çš„å¢åˆ æ”¹ã€æŸ¥è¯¢æ“ä½œï¼ˆversion 1.0 \ version 2.0)</span></span><br><span class="line"><span class="comment">//version2.0çš„å¢åˆ æ”¹public void update(Connection conn,String sql,Object ... args)&#123;&#125;</span></span><br><span class="line"><span class="comment">//version2.0çš„æŸ¥è¯¢ public &lt;T&gt; T getInstance(Connection conn,Class&lt;T&gt; clazz,String sql,Object ... args)&#123;&#125;</span></span><br><span class="line">        <span class="comment">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„QueryRunnerç±»</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤æ•°æ®</span></span><br><span class="line">        conn.commit();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//å›æ»šæ•°æ®</span></span><br><span class="line">            conn.rollback();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e1) &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">        <span class="comment">//3.å…³é—­è¿æ¥ç­‰æ“ä½œ</span></span><br><span class="line">        <span class="comment">//â‘  JDBCUtils.closeResource();</span></span><br><span class="line">        <span class="comment">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„DbUtilsç±»æä¾›äº†å…³é—­çš„ç›¸å…³æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="post-bottom-tags-and-share border-box"><div></div><div></div></div><div class="post-nav border-box"><div class="prev-post"><a class="prev" rel="prev" href="/2022/03/16/CqjtuSchoolApi/" title="CqjtuSchoolApi"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">CqjtuSchoolApi</span> <span class="post-nav-item">ä¸Šä¸€ç¯‡</span></span></a></div><div class="next-post"><a class="next" rel="next" href="/2021/08/19/MySQL%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/" title="MySQLåŸºç¡€æ•™ç¨‹"><span class="title flex-center"><span class="post-nav-title-item text-ellipsis">MySQLåŸºç¡€æ•™ç¨‹</span> <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comments-container border-box"><div id="comments-anchor" class="comment-area-title border-box"><i class="fas fa-comments"></i>&nbsp;è¯„è®º</div><div class="comment-plugin-fail border-box"><span class="fail-tip">è¯„è®ºæ’ä»¶åŠ è½½å¤±è´¥</span> <button class="reload keep-button">ç‚¹å‡»é‡æ–°åŠ è½½</button></div><div class="comment-plugin-loading flex-center border-box"><i class="loading-icon fa-solid fa-spinner fa-spin"></i> <span class="load-tip">æ­£åœ¨åŠ è½½è¯„è®ºæ’ä»¶</span></div><script data-pjax>window.KeepCommentPlugin={},window.KeepCommentPlugin.hideLoading=()=>{document.querySelector(".comments-container .comment-plugin-loading").style.display="none"},window.KeepCommentPlugin.loadFailHandle=()=>{window.KeepCommentPlugin.hideLoading();const e=document.querySelector(".comments-container .comment-plugin-fail");e.style.display="flex",e.querySelector(".reload").addEventListener("click",()=>{window.location.reload()})}</script><div class="waline-comment-container"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3/dist/waline.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3/dist/waline-meta.css"><div id="waline-comment"></div><script data-pjax>window.KeepCommentPlugin.walineOptions=JSON.parse("{}".replace(/&#34;/g,'"')),window.KeepCommentPlugin.walineOptions.el="#waline-comment",window.KeepCommentPlugin.walineOptions.comment=".post-comments-count",window.KeepCommentPlugin.walineOptions.serverURL="https://hexo-waline-comment-bay.vercel.app/",window.KeepCommentPlugin.walineOptions.lang="zh-CN",window.KeepCommentPlugin.walineOptions.reaction=!0</script><script data-pjax async type="module">import{init}from"//cdn.jsdelivr.net/npm/@waline/client@v3/dist/waline.js";window.KeepCommentPlugin.initWaline=()=>{init?(init(window.KeepCommentPlugin.walineOptions),window.KeepCommentPlugin.hideLoading()):setTimeout(()=>{window.KeepCommentPlugin.initWaline()},1e3)},setTimeout(()=>{window.KeepCommentPlugin.initWaline()},1200)</script></div></div></div></div><div class="pc-post-toc right-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#JDBC%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF"><span class="nav-number">1.</span> <span class="nav-text">JDBCæ ¸å¿ƒæŠ€æœ¯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9AJDBC%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 æ•°æ®çš„æŒä¹…åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Java%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-JDBC%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3 JDBCä»‹ç»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-JDBC%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4 JDBCä½“ç³»ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-JDBC%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.1.5.</span> <span class="nav-text">1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0%EF%BC%9A%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.</span> <span class="nav-text">ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E8%A6%81%E7%B4%A0%E4%B8%80%EF%BC%9ADriver%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-Driver%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">2.1.1 Driveræ¥å£ä»‹ç»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%B3%A8%E5%86%8CJDBC%E9%A9%B1%E5%8A%A8"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E8%A6%81%E7%B4%A0%E4%BA%8C%EF%BC%9AURL"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 è¦ç´ äºŒï¼šURL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E8%A6%81%E7%B4%A0%E4%B8%89%EF%BC%9A%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%BE%E4%BE%8B"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">2.4.1 è¿æ¥æ–¹å¼ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">2.4.2 è¿æ¥æ–¹å¼äºŒ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-3-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%89"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">2.4.3 è¿æ¥æ–¹å¼ä¸‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-4-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E5%9B%9B"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">2.4.4 è¿æ¥æ–¹å¼å››</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-5-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%94-%E6%9C%80%E7%BB%88%E7%89%88"><span class="nav-number">1.2.4.5.</span> <span class="nav-text">2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.</span> <span class="nav-text">ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%93%8D%E4%BD%9C%E5%92%8C%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E4%BD%BF%E7%94%A8Statement%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E5%BC%8A%E7%AB%AF"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-PreparedStatement%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 PreparedStatementçš„ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-PreparedStatement%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">3.3.1 PreparedStatementä»‹ç»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-PreparedStatement-vs-Statement"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">3.3.2 PreparedStatement vs Statement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-Java%E4%B8%8ESQL%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%A1%A8"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E5%A2%9E%E3%80%81%E5%88%A0%E3%80%81%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.4.</span> <span class="nav-text">3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-5-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.5.</span> <span class="nav-text">3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-ResultSet%E4%B8%8EResultSetMetaData"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 ResultSetä¸ResultSetMetaData</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-ResultSet"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">3.4.1 ResultSet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-ResultSetMetaData"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">3.4.2 ResultSetMetaData</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E8%B5%84%E6%BA%90%E7%9A%84%E9%87%8A%E6%94%BE"><span class="nav-number">1.3.5.</span> <span class="nav-text">3.5 èµ„æºçš„é‡Šæ”¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-JDBC-API%E5%B0%8F%E7%BB%93"><span class="nav-number">1.3.6.</span> <span class="nav-text">3.6 JDBC APIå°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%BB%83%E4%B9%A0"><span class="nav-number">1.4.</span> <span class="nav-text">ç« èŠ‚ç»ƒä¹ </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%93%8D%E4%BD%9CBLOB%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="nav-number">1.5.</span> <span class="nav-text">ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-MySQL-BLOB%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.1.</span> <span class="nav-text">4.1 MySQL BLOBç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%90%91%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.2.</span> <span class="nav-text">4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E7%9A%84Blob%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="nav-number">1.5.3.</span> <span class="nav-text">4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-%E4%BB%8E%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E8%AF%BB%E5%8F%96%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.4.</span> <span class="nav-text">4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0-%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="nav-number">1.6.</span> <span class="nav-text">ç¬¬5ç«  æ‰¹é‡æ’å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E6%89%B9%E9%87%8F%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.6.1.</span> <span class="nav-text">5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E9%AB%98%E6%95%88%E7%9A%84%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="nav-number">1.6.2.</span> <span class="nav-text">5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8Statement"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%89"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">5.2.3 å®ç°å±‚æ¬¡ä¸‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-4-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E5%9B%9B"><span class="nav-number">1.6.2.4.</span> <span class="nav-text">5.2.4 å®ç°å±‚æ¬¡å››</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC6%E7%AB%A0%EF%BC%9A-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1"><span class="nav-number">1.7.</span> <span class="nav-text">ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.7.1.</span> <span class="nav-text">6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-JDBC%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="nav-number">1.7.2.</span> <span class="nav-text">6.2 JDBCäº‹åŠ¡å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E5%B1%9E%E6%80%A7"><span class="nav-number">1.7.3.</span> <span class="nav-text">6.3 äº‹åŠ¡çš„ACIDå±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="nav-number">1.7.3.1.</span> <span class="nav-text">6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-2-%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.7.3.2.</span> <span class="nav-text">6.3.2 å››ç§éš”ç¦»çº§åˆ«</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-3-%E5%9C%A8MySql%E4%B8%AD%E8%AE%BE%E7%BD%AE%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.7.3.3.</span> <span class="nav-text">6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC7%E7%AB%A0%EF%BC%9ADAO%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.8.</span> <span class="nav-text">ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BaseDAO-java%E3%80%91"><span class="nav-number">1.8.1.</span> <span class="nav-text">ã€BaseDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BookDAO-java%E3%80%91"><span class="nav-number">1.8.2.</span> <span class="nav-text">ã€BookDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90UserDAO-java%E3%80%91"><span class="nav-number">1.8.3.</span> <span class="nav-text">ã€UserDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BookDaoImpl-java%E3%80%91"><span class="nav-number">1.8.4.</span> <span class="nav-text">ã€BookDaoImpl.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90UserDaoImpl-java%E3%80%91"><span class="nav-number">1.8.5.</span> <span class="nav-text">ã€UserDaoImpl.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Book-java%E3%80%91"><span class="nav-number">1.8.6.</span> <span class="nav-text">ã€Book.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Page-java%E3%80%91"><span class="nav-number">1.8.7.</span> <span class="nav-text">ã€Page.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90User-java%E3%80%91"><span class="nav-number">1.8.8.</span> <span class="nav-text">ã€User.javaã€‘</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC8%E7%AB%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.</span> <span class="nav-text">ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-JDBC%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="nav-number">1.9.1.</span> <span class="nav-text">8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%8A%80%E6%9C%AF"><span class="nav-number">1.9.2.</span> <span class="nav-text">8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-%E5%A4%9A%E7%A7%8D%E5%BC%80%E6%BA%90%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.</span> <span class="nav-text">8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-1-C3P0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-2-DBCP%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-3-Druid%EF%BC%88%E5%BE%B7%E9%B2%81%E4%BC%8A%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC9%E7%AB%A0%EF%BC%9AApache-DBUtils%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="nav-number">1.10.</span> <span class="nav-text">ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-Apache-DBUtils%E7%AE%80%E4%BB%8B"><span class="nav-number">1.10.1.</span> <span class="nav-text">9.1 Apache-DBUtilsç®€ä»‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E4%B8%BB%E8%A6%81API%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.10.2.</span> <span class="nav-text">9.2 ä¸»è¦APIçš„ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-1-DbUtils"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">9.2.1 DbUtils</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-2-QueryRunner%E7%B1%BB"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">9.2.2 QueryRunnerç±»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-3-ResultSetHandler%E6%8E%A5%E5%8F%A3%E5%8F%8A%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC%E6%80%BB%E7%BB%93"><span class="nav-number">1.11.</span> <span class="nav-text">JDBCæ€»ç»“</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom border-box"><footer class="footer border-box"><div class="copyright-info info-item">&copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2024 &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">hider</a></div><div class="theme-info info-item">ç”±&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;é©±åŠ¨&nbsp;&&nbsp;ä¸»é¢˜&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a></div><div class="deploy-info info-item">æœ¬ç«™ç”± <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span>æä¾›éƒ¨ç½²æœåŠ¡</div></footer></div></div><div class="post-tools right-toc"><div class="post-tools-container border-box"><ul class="post-tools-list border-box"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class="post-comments-count"></span></li><li class="tools-item flex-center full-screen"><i class="fa-solid fa-expand"></i></li></ul></div></div><div class="side-tools"><div class="side-tools-container border-box"><ul class="side-tools-list side-tools-show-handle border-box"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-toggle-theme-mode flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list border-box"><li class="tools-item toggle-show-toc-tablet flex-center"><i class="fas fa-list"></i></li><li class="tools-item go-to-comments-tablet flex-center"><i class="fas fa-comment"></i></li><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center show-arrow"><i class="arrow fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div><div class="tablet-post-toc-mask"><div class="tablet-post-toc"><div class="post-toc-wrap border-box"><div class="post-toc border-box"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#JDBC%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF"><span class="nav-number">1.</span> <span class="nav-text">JDBCæ ¸å¿ƒæŠ€æœ¯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9AJDBC%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 æ•°æ®çš„æŒä¹…åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Java%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-JDBC%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3 JDBCä»‹ç»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-JDBC%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4 JDBCä½“ç³»ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-JDBC%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.1.5.</span> <span class="nav-text">1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0%EF%BC%9A%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.</span> <span class="nav-text">ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E8%A6%81%E7%B4%A0%E4%B8%80%EF%BC%9ADriver%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-Driver%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">2.1.1 Driveræ¥å£ä»‹ç»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%B3%A8%E5%86%8CJDBC%E9%A9%B1%E5%8A%A8"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E8%A6%81%E7%B4%A0%E4%BA%8C%EF%BC%9AURL"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 è¦ç´ äºŒï¼šURL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E8%A6%81%E7%B4%A0%E4%B8%89%EF%BC%9A%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%BE%E4%BE%8B"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">2.4.1 è¿æ¥æ–¹å¼ä¸€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">2.4.2 è¿æ¥æ–¹å¼äºŒ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-3-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%89"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">2.4.3 è¿æ¥æ–¹å¼ä¸‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-4-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E5%9B%9B"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">2.4.4 è¿æ¥æ–¹å¼å››</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-5-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%94-%E6%9C%80%E7%BB%88%E7%89%88"><span class="nav-number">1.2.4.5.</span> <span class="nav-text">2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.</span> <span class="nav-text">ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E6%93%8D%E4%BD%9C%E5%92%8C%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E4%BD%BF%E7%94%A8Statement%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E5%BC%8A%E7%AB%AF"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-PreparedStatement%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 PreparedStatementçš„ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-PreparedStatement%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">3.3.1 PreparedStatementä»‹ç»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-PreparedStatement-vs-Statement"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">3.3.2 PreparedStatement vs Statement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-Java%E4%B8%8ESQL%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%A1%A8"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E5%A2%9E%E3%80%81%E5%88%A0%E3%80%81%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.4.</span> <span class="nav-text">3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-5-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.3.5.</span> <span class="nav-text">3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-ResultSet%E4%B8%8EResultSetMetaData"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 ResultSetä¸ResultSetMetaData</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-ResultSet"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">3.4.1 ResultSet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-ResultSetMetaData"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">3.4.2 ResultSetMetaData</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E8%B5%84%E6%BA%90%E7%9A%84%E9%87%8A%E6%94%BE"><span class="nav-number">1.3.5.</span> <span class="nav-text">3.5 èµ„æºçš„é‡Šæ”¾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-JDBC-API%E5%B0%8F%E7%BB%93"><span class="nav-number">1.3.6.</span> <span class="nav-text">3.6 JDBC APIå°ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%A0%E8%8A%82%E7%BB%83%E4%B9%A0"><span class="nav-number">1.4.</span> <span class="nav-text">ç« èŠ‚ç»ƒä¹ </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%93%8D%E4%BD%9CBLOB%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="nav-number">1.5.</span> <span class="nav-text">ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-MySQL-BLOB%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.1.</span> <span class="nav-text">4.1 MySQL BLOBç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%90%91%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.2.</span> <span class="nav-text">4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E7%9A%84Blob%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="nav-number">1.5.3.</span> <span class="nav-text">4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-%E4%BB%8E%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E8%AF%BB%E5%8F%96%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.5.4.</span> <span class="nav-text">4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0-%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="nav-number">1.6.</span> <span class="nav-text">ç¬¬5ç«  æ‰¹é‡æ’å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E6%89%B9%E9%87%8F%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.6.1.</span> <span class="nav-text">5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E9%AB%98%E6%95%88%E7%9A%84%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="nav-number">1.6.2.</span> <span class="nav-text">5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8Statement"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-3-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%89"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">5.2.3 å®ç°å±‚æ¬¡ä¸‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-4-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E5%9B%9B"><span class="nav-number">1.6.2.4.</span> <span class="nav-text">5.2.4 å®ç°å±‚æ¬¡å››</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC6%E7%AB%A0%EF%BC%9A-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1"><span class="nav-number">1.7.</span> <span class="nav-text">ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.7.1.</span> <span class="nav-text">6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-JDBC%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="nav-number">1.7.2.</span> <span class="nav-text">6.2 JDBCäº‹åŠ¡å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E5%B1%9E%E6%80%A7"><span class="nav-number">1.7.3.</span> <span class="nav-text">6.3 äº‹åŠ¡çš„ACIDå±æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="nav-number">1.7.3.1.</span> <span class="nav-text">6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-2-%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.7.3.2.</span> <span class="nav-text">6.3.2 å››ç§éš”ç¦»çº§åˆ«</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-3-%E5%9C%A8MySql%E4%B8%AD%E8%AE%BE%E7%BD%AE%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.7.3.3.</span> <span class="nav-text">6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC7%E7%AB%A0%EF%BC%9ADAO%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.8.</span> <span class="nav-text">ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BaseDAO-java%E3%80%91"><span class="nav-number">1.8.1.</span> <span class="nav-text">ã€BaseDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BookDAO-java%E3%80%91"><span class="nav-number">1.8.2.</span> <span class="nav-text">ã€BookDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90UserDAO-java%E3%80%91"><span class="nav-number">1.8.3.</span> <span class="nav-text">ã€UserDAO.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90BookDaoImpl-java%E3%80%91"><span class="nav-number">1.8.4.</span> <span class="nav-text">ã€BookDaoImpl.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90UserDaoImpl-java%E3%80%91"><span class="nav-number">1.8.5.</span> <span class="nav-text">ã€UserDaoImpl.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Book-java%E3%80%91"><span class="nav-number">1.8.6.</span> <span class="nav-text">ã€Book.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Page-java%E3%80%91"><span class="nav-number">1.8.7.</span> <span class="nav-text">ã€Page.javaã€‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90User-java%E3%80%91"><span class="nav-number">1.8.8.</span> <span class="nav-text">ã€User.javaã€‘</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC8%E7%AB%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.</span> <span class="nav-text">ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-JDBC%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="nav-number">1.9.1.</span> <span class="nav-text">8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%8A%80%E6%9C%AF"><span class="nav-number">1.9.2.</span> <span class="nav-text">8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-%E5%A4%9A%E7%A7%8D%E5%BC%80%E6%BA%90%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.</span> <span class="nav-text">8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-1-C3P0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.1.</span> <span class="nav-text">8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-2-DBCP%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.2.</span> <span class="nav-text">8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-3-3-Druid%EF%BC%88%E5%BE%B7%E9%B2%81%E4%BC%8A%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">1.9.3.3.</span> <span class="nav-text">8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC9%E7%AB%A0%EF%BC%9AApache-DBUtils%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="nav-number">1.10.</span> <span class="nav-text">ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-Apache-DBUtils%E7%AE%80%E4%BB%8B"><span class="nav-number">1.10.1.</span> <span class="nav-text">9.1 Apache-DBUtilsç®€ä»‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E4%B8%BB%E8%A6%81API%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.10.2.</span> <span class="nav-text">9.2 ä¸»è¦APIçš„ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-1-DbUtils"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">9.2.1 DbUtils</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-2-QueryRunner%E7%B1%BB"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">9.2.2 QueryRunnerç±»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-2-3-ResultSetHandler%E6%8E%A5%E5%8F%A3%E5%8F%8A%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC%E6%80%BB%E7%BB%93"><span class="nav-number">1.11.</span> <span class="nav-text">JDBCæ€»ç»“</span></a></li></ol></li></ol></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/toggle-theme.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/code-block.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/lazyload.js"></script><div class="pjax"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/post/post-helper.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/post/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.2.5/source/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.initExecute()})})</script></body></html>